
<!doctype html>
<html lang="en">

<head>
    <title>Code coverage report for Backend/services/userServices.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <link rel="shortcut icon" type="image/x-icon" href="../../favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
    
<body>
<div class='wrapper'>
    <div class='pad1'>
        <h1><a href="../../index.html">All files</a> / <a href="index.html">Backend/services</a> userServices.js</h1>
        <div class='clearfix'>
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Statements</span>
                <span class='fraction'>0/429</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Branches</span>
                <span class='fraction'>0/249</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Functions</span>
                <span class='fraction'>0/39</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Lines</span>
                <span class='fraction'>0/408</span>
            </div>
        
            
        </div>
        <p class="quiet">
            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
        </p>
        <template id="filterTemplate">
            <div class="quiet">
                Filter:
                <input type="search" id="fileSearch">
            </div>
        </template>
    </div>
    <div class='status-line low'></div>
    <pre><table class="coverage">
<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
<a name='L2'></a><a href='#L2'>2</a>
<a name='L3'></a><a href='#L3'>3</a>
<a name='L4'></a><a href='#L4'>4</a>
<a name='L5'></a><a href='#L5'>5</a>
<a name='L6'></a><a href='#L6'>6</a>
<a name='L7'></a><a href='#L7'>7</a>
<a name='L8'></a><a href='#L8'>8</a>
<a name='L9'></a><a href='#L9'>9</a>
<a name='L10'></a><a href='#L10'>10</a>
<a name='L11'></a><a href='#L11'>11</a>
<a name='L12'></a><a href='#L12'>12</a>
<a name='L13'></a><a href='#L13'>13</a>
<a name='L14'></a><a href='#L14'>14</a>
<a name='L15'></a><a href='#L15'>15</a>
<a name='L16'></a><a href='#L16'>16</a>
<a name='L17'></a><a href='#L17'>17</a>
<a name='L18'></a><a href='#L18'>18</a>
<a name='L19'></a><a href='#L19'>19</a>
<a name='L20'></a><a href='#L20'>20</a>
<a name='L21'></a><a href='#L21'>21</a>
<a name='L22'></a><a href='#L22'>22</a>
<a name='L23'></a><a href='#L23'>23</a>
<a name='L24'></a><a href='#L24'>24</a>
<a name='L25'></a><a href='#L25'>25</a>
<a name='L26'></a><a href='#L26'>26</a>
<a name='L27'></a><a href='#L27'>27</a>
<a name='L28'></a><a href='#L28'>28</a>
<a name='L29'></a><a href='#L29'>29</a>
<a name='L30'></a><a href='#L30'>30</a>
<a name='L31'></a><a href='#L31'>31</a>
<a name='L32'></a><a href='#L32'>32</a>
<a name='L33'></a><a href='#L33'>33</a>
<a name='L34'></a><a href='#L34'>34</a>
<a name='L35'></a><a href='#L35'>35</a>
<a name='L36'></a><a href='#L36'>36</a>
<a name='L37'></a><a href='#L37'>37</a>
<a name='L38'></a><a href='#L38'>38</a>
<a name='L39'></a><a href='#L39'>39</a>
<a name='L40'></a><a href='#L40'>40</a>
<a name='L41'></a><a href='#L41'>41</a>
<a name='L42'></a><a href='#L42'>42</a>
<a name='L43'></a><a href='#L43'>43</a>
<a name='L44'></a><a href='#L44'>44</a>
<a name='L45'></a><a href='#L45'>45</a>
<a name='L46'></a><a href='#L46'>46</a>
<a name='L47'></a><a href='#L47'>47</a>
<a name='L48'></a><a href='#L48'>48</a>
<a name='L49'></a><a href='#L49'>49</a>
<a name='L50'></a><a href='#L50'>50</a>
<a name='L51'></a><a href='#L51'>51</a>
<a name='L52'></a><a href='#L52'>52</a>
<a name='L53'></a><a href='#L53'>53</a>
<a name='L54'></a><a href='#L54'>54</a>
<a name='L55'></a><a href='#L55'>55</a>
<a name='L56'></a><a href='#L56'>56</a>
<a name='L57'></a><a href='#L57'>57</a>
<a name='L58'></a><a href='#L58'>58</a>
<a name='L59'></a><a href='#L59'>59</a>
<a name='L60'></a><a href='#L60'>60</a>
<a name='L61'></a><a href='#L61'>61</a>
<a name='L62'></a><a href='#L62'>62</a>
<a name='L63'></a><a href='#L63'>63</a>
<a name='L64'></a><a href='#L64'>64</a>
<a name='L65'></a><a href='#L65'>65</a>
<a name='L66'></a><a href='#L66'>66</a>
<a name='L67'></a><a href='#L67'>67</a>
<a name='L68'></a><a href='#L68'>68</a>
<a name='L69'></a><a href='#L69'>69</a>
<a name='L70'></a><a href='#L70'>70</a>
<a name='L71'></a><a href='#L71'>71</a>
<a name='L72'></a><a href='#L72'>72</a>
<a name='L73'></a><a href='#L73'>73</a>
<a name='L74'></a><a href='#L74'>74</a>
<a name='L75'></a><a href='#L75'>75</a>
<a name='L76'></a><a href='#L76'>76</a>
<a name='L77'></a><a href='#L77'>77</a>
<a name='L78'></a><a href='#L78'>78</a>
<a name='L79'></a><a href='#L79'>79</a>
<a name='L80'></a><a href='#L80'>80</a>
<a name='L81'></a><a href='#L81'>81</a>
<a name='L82'></a><a href='#L82'>82</a>
<a name='L83'></a><a href='#L83'>83</a>
<a name='L84'></a><a href='#L84'>84</a>
<a name='L85'></a><a href='#L85'>85</a>
<a name='L86'></a><a href='#L86'>86</a>
<a name='L87'></a><a href='#L87'>87</a>
<a name='L88'></a><a href='#L88'>88</a>
<a name='L89'></a><a href='#L89'>89</a>
<a name='L90'></a><a href='#L90'>90</a>
<a name='L91'></a><a href='#L91'>91</a>
<a name='L92'></a><a href='#L92'>92</a>
<a name='L93'></a><a href='#L93'>93</a>
<a name='L94'></a><a href='#L94'>94</a>
<a name='L95'></a><a href='#L95'>95</a>
<a name='L96'></a><a href='#L96'>96</a>
<a name='L97'></a><a href='#L97'>97</a>
<a name='L98'></a><a href='#L98'>98</a>
<a name='L99'></a><a href='#L99'>99</a>
<a name='L100'></a><a href='#L100'>100</a>
<a name='L101'></a><a href='#L101'>101</a>
<a name='L102'></a><a href='#L102'>102</a>
<a name='L103'></a><a href='#L103'>103</a>
<a name='L104'></a><a href='#L104'>104</a>
<a name='L105'></a><a href='#L105'>105</a>
<a name='L106'></a><a href='#L106'>106</a>
<a name='L107'></a><a href='#L107'>107</a>
<a name='L108'></a><a href='#L108'>108</a>
<a name='L109'></a><a href='#L109'>109</a>
<a name='L110'></a><a href='#L110'>110</a>
<a name='L111'></a><a href='#L111'>111</a>
<a name='L112'></a><a href='#L112'>112</a>
<a name='L113'></a><a href='#L113'>113</a>
<a name='L114'></a><a href='#L114'>114</a>
<a name='L115'></a><a href='#L115'>115</a>
<a name='L116'></a><a href='#L116'>116</a>
<a name='L117'></a><a href='#L117'>117</a>
<a name='L118'></a><a href='#L118'>118</a>
<a name='L119'></a><a href='#L119'>119</a>
<a name='L120'></a><a href='#L120'>120</a>
<a name='L121'></a><a href='#L121'>121</a>
<a name='L122'></a><a href='#L122'>122</a>
<a name='L123'></a><a href='#L123'>123</a>
<a name='L124'></a><a href='#L124'>124</a>
<a name='L125'></a><a href='#L125'>125</a>
<a name='L126'></a><a href='#L126'>126</a>
<a name='L127'></a><a href='#L127'>127</a>
<a name='L128'></a><a href='#L128'>128</a>
<a name='L129'></a><a href='#L129'>129</a>
<a name='L130'></a><a href='#L130'>130</a>
<a name='L131'></a><a href='#L131'>131</a>
<a name='L132'></a><a href='#L132'>132</a>
<a name='L133'></a><a href='#L133'>133</a>
<a name='L134'></a><a href='#L134'>134</a>
<a name='L135'></a><a href='#L135'>135</a>
<a name='L136'></a><a href='#L136'>136</a>
<a name='L137'></a><a href='#L137'>137</a>
<a name='L138'></a><a href='#L138'>138</a>
<a name='L139'></a><a href='#L139'>139</a>
<a name='L140'></a><a href='#L140'>140</a>
<a name='L141'></a><a href='#L141'>141</a>
<a name='L142'></a><a href='#L142'>142</a>
<a name='L143'></a><a href='#L143'>143</a>
<a name='L144'></a><a href='#L144'>144</a>
<a name='L145'></a><a href='#L145'>145</a>
<a name='L146'></a><a href='#L146'>146</a>
<a name='L147'></a><a href='#L147'>147</a>
<a name='L148'></a><a href='#L148'>148</a>
<a name='L149'></a><a href='#L149'>149</a>
<a name='L150'></a><a href='#L150'>150</a>
<a name='L151'></a><a href='#L151'>151</a>
<a name='L152'></a><a href='#L152'>152</a>
<a name='L153'></a><a href='#L153'>153</a>
<a name='L154'></a><a href='#L154'>154</a>
<a name='L155'></a><a href='#L155'>155</a>
<a name='L156'></a><a href='#L156'>156</a>
<a name='L157'></a><a href='#L157'>157</a>
<a name='L158'></a><a href='#L158'>158</a>
<a name='L159'></a><a href='#L159'>159</a>
<a name='L160'></a><a href='#L160'>160</a>
<a name='L161'></a><a href='#L161'>161</a>
<a name='L162'></a><a href='#L162'>162</a>
<a name='L163'></a><a href='#L163'>163</a>
<a name='L164'></a><a href='#L164'>164</a>
<a name='L165'></a><a href='#L165'>165</a>
<a name='L166'></a><a href='#L166'>166</a>
<a name='L167'></a><a href='#L167'>167</a>
<a name='L168'></a><a href='#L168'>168</a>
<a name='L169'></a><a href='#L169'>169</a>
<a name='L170'></a><a href='#L170'>170</a>
<a name='L171'></a><a href='#L171'>171</a>
<a name='L172'></a><a href='#L172'>172</a>
<a name='L173'></a><a href='#L173'>173</a>
<a name='L174'></a><a href='#L174'>174</a>
<a name='L175'></a><a href='#L175'>175</a>
<a name='L176'></a><a href='#L176'>176</a>
<a name='L177'></a><a href='#L177'>177</a>
<a name='L178'></a><a href='#L178'>178</a>
<a name='L179'></a><a href='#L179'>179</a>
<a name='L180'></a><a href='#L180'>180</a>
<a name='L181'></a><a href='#L181'>181</a>
<a name='L182'></a><a href='#L182'>182</a>
<a name='L183'></a><a href='#L183'>183</a>
<a name='L184'></a><a href='#L184'>184</a>
<a name='L185'></a><a href='#L185'>185</a>
<a name='L186'></a><a href='#L186'>186</a>
<a name='L187'></a><a href='#L187'>187</a>
<a name='L188'></a><a href='#L188'>188</a>
<a name='L189'></a><a href='#L189'>189</a>
<a name='L190'></a><a href='#L190'>190</a>
<a name='L191'></a><a href='#L191'>191</a>
<a name='L192'></a><a href='#L192'>192</a>
<a name='L193'></a><a href='#L193'>193</a>
<a name='L194'></a><a href='#L194'>194</a>
<a name='L195'></a><a href='#L195'>195</a>
<a name='L196'></a><a href='#L196'>196</a>
<a name='L197'></a><a href='#L197'>197</a>
<a name='L198'></a><a href='#L198'>198</a>
<a name='L199'></a><a href='#L199'>199</a>
<a name='L200'></a><a href='#L200'>200</a>
<a name='L201'></a><a href='#L201'>201</a>
<a name='L202'></a><a href='#L202'>202</a>
<a name='L203'></a><a href='#L203'>203</a>
<a name='L204'></a><a href='#L204'>204</a>
<a name='L205'></a><a href='#L205'>205</a>
<a name='L206'></a><a href='#L206'>206</a>
<a name='L207'></a><a href='#L207'>207</a>
<a name='L208'></a><a href='#L208'>208</a>
<a name='L209'></a><a href='#L209'>209</a>
<a name='L210'></a><a href='#L210'>210</a>
<a name='L211'></a><a href='#L211'>211</a>
<a name='L212'></a><a href='#L212'>212</a>
<a name='L213'></a><a href='#L213'>213</a>
<a name='L214'></a><a href='#L214'>214</a>
<a name='L215'></a><a href='#L215'>215</a>
<a name='L216'></a><a href='#L216'>216</a>
<a name='L217'></a><a href='#L217'>217</a>
<a name='L218'></a><a href='#L218'>218</a>
<a name='L219'></a><a href='#L219'>219</a>
<a name='L220'></a><a href='#L220'>220</a>
<a name='L221'></a><a href='#L221'>221</a>
<a name='L222'></a><a href='#L222'>222</a>
<a name='L223'></a><a href='#L223'>223</a>
<a name='L224'></a><a href='#L224'>224</a>
<a name='L225'></a><a href='#L225'>225</a>
<a name='L226'></a><a href='#L226'>226</a>
<a name='L227'></a><a href='#L227'>227</a>
<a name='L228'></a><a href='#L228'>228</a>
<a name='L229'></a><a href='#L229'>229</a>
<a name='L230'></a><a href='#L230'>230</a>
<a name='L231'></a><a href='#L231'>231</a>
<a name='L232'></a><a href='#L232'>232</a>
<a name='L233'></a><a href='#L233'>233</a>
<a name='L234'></a><a href='#L234'>234</a>
<a name='L235'></a><a href='#L235'>235</a>
<a name='L236'></a><a href='#L236'>236</a>
<a name='L237'></a><a href='#L237'>237</a>
<a name='L238'></a><a href='#L238'>238</a>
<a name='L239'></a><a href='#L239'>239</a>
<a name='L240'></a><a href='#L240'>240</a>
<a name='L241'></a><a href='#L241'>241</a>
<a name='L242'></a><a href='#L242'>242</a>
<a name='L243'></a><a href='#L243'>243</a>
<a name='L244'></a><a href='#L244'>244</a>
<a name='L245'></a><a href='#L245'>245</a>
<a name='L246'></a><a href='#L246'>246</a>
<a name='L247'></a><a href='#L247'>247</a>
<a name='L248'></a><a href='#L248'>248</a>
<a name='L249'></a><a href='#L249'>249</a>
<a name='L250'></a><a href='#L250'>250</a>
<a name='L251'></a><a href='#L251'>251</a>
<a name='L252'></a><a href='#L252'>252</a>
<a name='L253'></a><a href='#L253'>253</a>
<a name='L254'></a><a href='#L254'>254</a>
<a name='L255'></a><a href='#L255'>255</a>
<a name='L256'></a><a href='#L256'>256</a>
<a name='L257'></a><a href='#L257'>257</a>
<a name='L258'></a><a href='#L258'>258</a>
<a name='L259'></a><a href='#L259'>259</a>
<a name='L260'></a><a href='#L260'>260</a>
<a name='L261'></a><a href='#L261'>261</a>
<a name='L262'></a><a href='#L262'>262</a>
<a name='L263'></a><a href='#L263'>263</a>
<a name='L264'></a><a href='#L264'>264</a>
<a name='L265'></a><a href='#L265'>265</a>
<a name='L266'></a><a href='#L266'>266</a>
<a name='L267'></a><a href='#L267'>267</a>
<a name='L268'></a><a href='#L268'>268</a>
<a name='L269'></a><a href='#L269'>269</a>
<a name='L270'></a><a href='#L270'>270</a>
<a name='L271'></a><a href='#L271'>271</a>
<a name='L272'></a><a href='#L272'>272</a>
<a name='L273'></a><a href='#L273'>273</a>
<a name='L274'></a><a href='#L274'>274</a>
<a name='L275'></a><a href='#L275'>275</a>
<a name='L276'></a><a href='#L276'>276</a>
<a name='L277'></a><a href='#L277'>277</a>
<a name='L278'></a><a href='#L278'>278</a>
<a name='L279'></a><a href='#L279'>279</a>
<a name='L280'></a><a href='#L280'>280</a>
<a name='L281'></a><a href='#L281'>281</a>
<a name='L282'></a><a href='#L282'>282</a>
<a name='L283'></a><a href='#L283'>283</a>
<a name='L284'></a><a href='#L284'>284</a>
<a name='L285'></a><a href='#L285'>285</a>
<a name='L286'></a><a href='#L286'>286</a>
<a name='L287'></a><a href='#L287'>287</a>
<a name='L288'></a><a href='#L288'>288</a>
<a name='L289'></a><a href='#L289'>289</a>
<a name='L290'></a><a href='#L290'>290</a>
<a name='L291'></a><a href='#L291'>291</a>
<a name='L292'></a><a href='#L292'>292</a>
<a name='L293'></a><a href='#L293'>293</a>
<a name='L294'></a><a href='#L294'>294</a>
<a name='L295'></a><a href='#L295'>295</a>
<a name='L296'></a><a href='#L296'>296</a>
<a name='L297'></a><a href='#L297'>297</a>
<a name='L298'></a><a href='#L298'>298</a>
<a name='L299'></a><a href='#L299'>299</a>
<a name='L300'></a><a href='#L300'>300</a>
<a name='L301'></a><a href='#L301'>301</a>
<a name='L302'></a><a href='#L302'>302</a>
<a name='L303'></a><a href='#L303'>303</a>
<a name='L304'></a><a href='#L304'>304</a>
<a name='L305'></a><a href='#L305'>305</a>
<a name='L306'></a><a href='#L306'>306</a>
<a name='L307'></a><a href='#L307'>307</a>
<a name='L308'></a><a href='#L308'>308</a>
<a name='L309'></a><a href='#L309'>309</a>
<a name='L310'></a><a href='#L310'>310</a>
<a name='L311'></a><a href='#L311'>311</a>
<a name='L312'></a><a href='#L312'>312</a>
<a name='L313'></a><a href='#L313'>313</a>
<a name='L314'></a><a href='#L314'>314</a>
<a name='L315'></a><a href='#L315'>315</a>
<a name='L316'></a><a href='#L316'>316</a>
<a name='L317'></a><a href='#L317'>317</a>
<a name='L318'></a><a href='#L318'>318</a>
<a name='L319'></a><a href='#L319'>319</a>
<a name='L320'></a><a href='#L320'>320</a>
<a name='L321'></a><a href='#L321'>321</a>
<a name='L322'></a><a href='#L322'>322</a>
<a name='L323'></a><a href='#L323'>323</a>
<a name='L324'></a><a href='#L324'>324</a>
<a name='L325'></a><a href='#L325'>325</a>
<a name='L326'></a><a href='#L326'>326</a>
<a name='L327'></a><a href='#L327'>327</a>
<a name='L328'></a><a href='#L328'>328</a>
<a name='L329'></a><a href='#L329'>329</a>
<a name='L330'></a><a href='#L330'>330</a>
<a name='L331'></a><a href='#L331'>331</a>
<a name='L332'></a><a href='#L332'>332</a>
<a name='L333'></a><a href='#L333'>333</a>
<a name='L334'></a><a href='#L334'>334</a>
<a name='L335'></a><a href='#L335'>335</a>
<a name='L336'></a><a href='#L336'>336</a>
<a name='L337'></a><a href='#L337'>337</a>
<a name='L338'></a><a href='#L338'>338</a>
<a name='L339'></a><a href='#L339'>339</a>
<a name='L340'></a><a href='#L340'>340</a>
<a name='L341'></a><a href='#L341'>341</a>
<a name='L342'></a><a href='#L342'>342</a>
<a name='L343'></a><a href='#L343'>343</a>
<a name='L344'></a><a href='#L344'>344</a>
<a name='L345'></a><a href='#L345'>345</a>
<a name='L346'></a><a href='#L346'>346</a>
<a name='L347'></a><a href='#L347'>347</a>
<a name='L348'></a><a href='#L348'>348</a>
<a name='L349'></a><a href='#L349'>349</a>
<a name='L350'></a><a href='#L350'>350</a>
<a name='L351'></a><a href='#L351'>351</a>
<a name='L352'></a><a href='#L352'>352</a>
<a name='L353'></a><a href='#L353'>353</a>
<a name='L354'></a><a href='#L354'>354</a>
<a name='L355'></a><a href='#L355'>355</a>
<a name='L356'></a><a href='#L356'>356</a>
<a name='L357'></a><a href='#L357'>357</a>
<a name='L358'></a><a href='#L358'>358</a>
<a name='L359'></a><a href='#L359'>359</a>
<a name='L360'></a><a href='#L360'>360</a>
<a name='L361'></a><a href='#L361'>361</a>
<a name='L362'></a><a href='#L362'>362</a>
<a name='L363'></a><a href='#L363'>363</a>
<a name='L364'></a><a href='#L364'>364</a>
<a name='L365'></a><a href='#L365'>365</a>
<a name='L366'></a><a href='#L366'>366</a>
<a name='L367'></a><a href='#L367'>367</a>
<a name='L368'></a><a href='#L368'>368</a>
<a name='L369'></a><a href='#L369'>369</a>
<a name='L370'></a><a href='#L370'>370</a>
<a name='L371'></a><a href='#L371'>371</a>
<a name='L372'></a><a href='#L372'>372</a>
<a name='L373'></a><a href='#L373'>373</a>
<a name='L374'></a><a href='#L374'>374</a>
<a name='L375'></a><a href='#L375'>375</a>
<a name='L376'></a><a href='#L376'>376</a>
<a name='L377'></a><a href='#L377'>377</a>
<a name='L378'></a><a href='#L378'>378</a>
<a name='L379'></a><a href='#L379'>379</a>
<a name='L380'></a><a href='#L380'>380</a>
<a name='L381'></a><a href='#L381'>381</a>
<a name='L382'></a><a href='#L382'>382</a>
<a name='L383'></a><a href='#L383'>383</a>
<a name='L384'></a><a href='#L384'>384</a>
<a name='L385'></a><a href='#L385'>385</a>
<a name='L386'></a><a href='#L386'>386</a>
<a name='L387'></a><a href='#L387'>387</a>
<a name='L388'></a><a href='#L388'>388</a>
<a name='L389'></a><a href='#L389'>389</a>
<a name='L390'></a><a href='#L390'>390</a>
<a name='L391'></a><a href='#L391'>391</a>
<a name='L392'></a><a href='#L392'>392</a>
<a name='L393'></a><a href='#L393'>393</a>
<a name='L394'></a><a href='#L394'>394</a>
<a name='L395'></a><a href='#L395'>395</a>
<a name='L396'></a><a href='#L396'>396</a>
<a name='L397'></a><a href='#L397'>397</a>
<a name='L398'></a><a href='#L398'>398</a>
<a name='L399'></a><a href='#L399'>399</a>
<a name='L400'></a><a href='#L400'>400</a>
<a name='L401'></a><a href='#L401'>401</a>
<a name='L402'></a><a href='#L402'>402</a>
<a name='L403'></a><a href='#L403'>403</a>
<a name='L404'></a><a href='#L404'>404</a>
<a name='L405'></a><a href='#L405'>405</a>
<a name='L406'></a><a href='#L406'>406</a>
<a name='L407'></a><a href='#L407'>407</a>
<a name='L408'></a><a href='#L408'>408</a>
<a name='L409'></a><a href='#L409'>409</a>
<a name='L410'></a><a href='#L410'>410</a>
<a name='L411'></a><a href='#L411'>411</a>
<a name='L412'></a><a href='#L412'>412</a>
<a name='L413'></a><a href='#L413'>413</a>
<a name='L414'></a><a href='#L414'>414</a>
<a name='L415'></a><a href='#L415'>415</a>
<a name='L416'></a><a href='#L416'>416</a>
<a name='L417'></a><a href='#L417'>417</a>
<a name='L418'></a><a href='#L418'>418</a>
<a name='L419'></a><a href='#L419'>419</a>
<a name='L420'></a><a href='#L420'>420</a>
<a name='L421'></a><a href='#L421'>421</a>
<a name='L422'></a><a href='#L422'>422</a>
<a name='L423'></a><a href='#L423'>423</a>
<a name='L424'></a><a href='#L424'>424</a>
<a name='L425'></a><a href='#L425'>425</a>
<a name='L426'></a><a href='#L426'>426</a>
<a name='L427'></a><a href='#L427'>427</a>
<a name='L428'></a><a href='#L428'>428</a>
<a name='L429'></a><a href='#L429'>429</a>
<a name='L430'></a><a href='#L430'>430</a>
<a name='L431'></a><a href='#L431'>431</a>
<a name='L432'></a><a href='#L432'>432</a>
<a name='L433'></a><a href='#L433'>433</a>
<a name='L434'></a><a href='#L434'>434</a>
<a name='L435'></a><a href='#L435'>435</a>
<a name='L436'></a><a href='#L436'>436</a>
<a name='L437'></a><a href='#L437'>437</a>
<a name='L438'></a><a href='#L438'>438</a>
<a name='L439'></a><a href='#L439'>439</a>
<a name='L440'></a><a href='#L440'>440</a>
<a name='L441'></a><a href='#L441'>441</a>
<a name='L442'></a><a href='#L442'>442</a>
<a name='L443'></a><a href='#L443'>443</a>
<a name='L444'></a><a href='#L444'>444</a>
<a name='L445'></a><a href='#L445'>445</a>
<a name='L446'></a><a href='#L446'>446</a>
<a name='L447'></a><a href='#L447'>447</a>
<a name='L448'></a><a href='#L448'>448</a>
<a name='L449'></a><a href='#L449'>449</a>
<a name='L450'></a><a href='#L450'>450</a>
<a name='L451'></a><a href='#L451'>451</a>
<a name='L452'></a><a href='#L452'>452</a>
<a name='L453'></a><a href='#L453'>453</a>
<a name='L454'></a><a href='#L454'>454</a>
<a name='L455'></a><a href='#L455'>455</a>
<a name='L456'></a><a href='#L456'>456</a>
<a name='L457'></a><a href='#L457'>457</a>
<a name='L458'></a><a href='#L458'>458</a>
<a name='L459'></a><a href='#L459'>459</a>
<a name='L460'></a><a href='#L460'>460</a>
<a name='L461'></a><a href='#L461'>461</a>
<a name='L462'></a><a href='#L462'>462</a>
<a name='L463'></a><a href='#L463'>463</a>
<a name='L464'></a><a href='#L464'>464</a>
<a name='L465'></a><a href='#L465'>465</a>
<a name='L466'></a><a href='#L466'>466</a>
<a name='L467'></a><a href='#L467'>467</a>
<a name='L468'></a><a href='#L468'>468</a>
<a name='L469'></a><a href='#L469'>469</a>
<a name='L470'></a><a href='#L470'>470</a>
<a name='L471'></a><a href='#L471'>471</a>
<a name='L472'></a><a href='#L472'>472</a>
<a name='L473'></a><a href='#L473'>473</a>
<a name='L474'></a><a href='#L474'>474</a>
<a name='L475'></a><a href='#L475'>475</a>
<a name='L476'></a><a href='#L476'>476</a>
<a name='L477'></a><a href='#L477'>477</a>
<a name='L478'></a><a href='#L478'>478</a>
<a name='L479'></a><a href='#L479'>479</a>
<a name='L480'></a><a href='#L480'>480</a>
<a name='L481'></a><a href='#L481'>481</a>
<a name='L482'></a><a href='#L482'>482</a>
<a name='L483'></a><a href='#L483'>483</a>
<a name='L484'></a><a href='#L484'>484</a>
<a name='L485'></a><a href='#L485'>485</a>
<a name='L486'></a><a href='#L486'>486</a>
<a name='L487'></a><a href='#L487'>487</a>
<a name='L488'></a><a href='#L488'>488</a>
<a name='L489'></a><a href='#L489'>489</a>
<a name='L490'></a><a href='#L490'>490</a>
<a name='L491'></a><a href='#L491'>491</a>
<a name='L492'></a><a href='#L492'>492</a>
<a name='L493'></a><a href='#L493'>493</a>
<a name='L494'></a><a href='#L494'>494</a>
<a name='L495'></a><a href='#L495'>495</a>
<a name='L496'></a><a href='#L496'>496</a>
<a name='L497'></a><a href='#L497'>497</a>
<a name='L498'></a><a href='#L498'>498</a>
<a name='L499'></a><a href='#L499'>499</a>
<a name='L500'></a><a href='#L500'>500</a>
<a name='L501'></a><a href='#L501'>501</a>
<a name='L502'></a><a href='#L502'>502</a>
<a name='L503'></a><a href='#L503'>503</a>
<a name='L504'></a><a href='#L504'>504</a>
<a name='L505'></a><a href='#L505'>505</a>
<a name='L506'></a><a href='#L506'>506</a>
<a name='L507'></a><a href='#L507'>507</a>
<a name='L508'></a><a href='#L508'>508</a>
<a name='L509'></a><a href='#L509'>509</a>
<a name='L510'></a><a href='#L510'>510</a>
<a name='L511'></a><a href='#L511'>511</a>
<a name='L512'></a><a href='#L512'>512</a>
<a name='L513'></a><a href='#L513'>513</a>
<a name='L514'></a><a href='#L514'>514</a>
<a name='L515'></a><a href='#L515'>515</a>
<a name='L516'></a><a href='#L516'>516</a>
<a name='L517'></a><a href='#L517'>517</a>
<a name='L518'></a><a href='#L518'>518</a>
<a name='L519'></a><a href='#L519'>519</a>
<a name='L520'></a><a href='#L520'>520</a>
<a name='L521'></a><a href='#L521'>521</a>
<a name='L522'></a><a href='#L522'>522</a>
<a name='L523'></a><a href='#L523'>523</a>
<a name='L524'></a><a href='#L524'>524</a>
<a name='L525'></a><a href='#L525'>525</a>
<a name='L526'></a><a href='#L526'>526</a>
<a name='L527'></a><a href='#L527'>527</a>
<a name='L528'></a><a href='#L528'>528</a>
<a name='L529'></a><a href='#L529'>529</a>
<a name='L530'></a><a href='#L530'>530</a>
<a name='L531'></a><a href='#L531'>531</a>
<a name='L532'></a><a href='#L532'>532</a>
<a name='L533'></a><a href='#L533'>533</a>
<a name='L534'></a><a href='#L534'>534</a>
<a name='L535'></a><a href='#L535'>535</a>
<a name='L536'></a><a href='#L536'>536</a>
<a name='L537'></a><a href='#L537'>537</a>
<a name='L538'></a><a href='#L538'>538</a>
<a name='L539'></a><a href='#L539'>539</a>
<a name='L540'></a><a href='#L540'>540</a>
<a name='L541'></a><a href='#L541'>541</a>
<a name='L542'></a><a href='#L542'>542</a>
<a name='L543'></a><a href='#L543'>543</a>
<a name='L544'></a><a href='#L544'>544</a>
<a name='L545'></a><a href='#L545'>545</a>
<a name='L546'></a><a href='#L546'>546</a>
<a name='L547'></a><a href='#L547'>547</a>
<a name='L548'></a><a href='#L548'>548</a>
<a name='L549'></a><a href='#L549'>549</a>
<a name='L550'></a><a href='#L550'>550</a>
<a name='L551'></a><a href='#L551'>551</a>
<a name='L552'></a><a href='#L552'>552</a>
<a name='L553'></a><a href='#L553'>553</a>
<a name='L554'></a><a href='#L554'>554</a>
<a name='L555'></a><a href='#L555'>555</a>
<a name='L556'></a><a href='#L556'>556</a>
<a name='L557'></a><a href='#L557'>557</a>
<a name='L558'></a><a href='#L558'>558</a>
<a name='L559'></a><a href='#L559'>559</a>
<a name='L560'></a><a href='#L560'>560</a>
<a name='L561'></a><a href='#L561'>561</a>
<a name='L562'></a><a href='#L562'>562</a>
<a name='L563'></a><a href='#L563'>563</a>
<a name='L564'></a><a href='#L564'>564</a>
<a name='L565'></a><a href='#L565'>565</a>
<a name='L566'></a><a href='#L566'>566</a>
<a name='L567'></a><a href='#L567'>567</a>
<a name='L568'></a><a href='#L568'>568</a>
<a name='L569'></a><a href='#L569'>569</a>
<a name='L570'></a><a href='#L570'>570</a>
<a name='L571'></a><a href='#L571'>571</a>
<a name='L572'></a><a href='#L572'>572</a>
<a name='L573'></a><a href='#L573'>573</a>
<a name='L574'></a><a href='#L574'>574</a>
<a name='L575'></a><a href='#L575'>575</a>
<a name='L576'></a><a href='#L576'>576</a>
<a name='L577'></a><a href='#L577'>577</a>
<a name='L578'></a><a href='#L578'>578</a>
<a name='L579'></a><a href='#L579'>579</a>
<a name='L580'></a><a href='#L580'>580</a>
<a name='L581'></a><a href='#L581'>581</a>
<a name='L582'></a><a href='#L582'>582</a>
<a name='L583'></a><a href='#L583'>583</a>
<a name='L584'></a><a href='#L584'>584</a>
<a name='L585'></a><a href='#L585'>585</a>
<a name='L586'></a><a href='#L586'>586</a>
<a name='L587'></a><a href='#L587'>587</a>
<a name='L588'></a><a href='#L588'>588</a>
<a name='L589'></a><a href='#L589'>589</a>
<a name='L590'></a><a href='#L590'>590</a>
<a name='L591'></a><a href='#L591'>591</a>
<a name='L592'></a><a href='#L592'>592</a>
<a name='L593'></a><a href='#L593'>593</a>
<a name='L594'></a><a href='#L594'>594</a>
<a name='L595'></a><a href='#L595'>595</a>
<a name='L596'></a><a href='#L596'>596</a>
<a name='L597'></a><a href='#L597'>597</a>
<a name='L598'></a><a href='#L598'>598</a>
<a name='L599'></a><a href='#L599'>599</a>
<a name='L600'></a><a href='#L600'>600</a>
<a name='L601'></a><a href='#L601'>601</a>
<a name='L602'></a><a href='#L602'>602</a>
<a name='L603'></a><a href='#L603'>603</a>
<a name='L604'></a><a href='#L604'>604</a>
<a name='L605'></a><a href='#L605'>605</a>
<a name='L606'></a><a href='#L606'>606</a>
<a name='L607'></a><a href='#L607'>607</a>
<a name='L608'></a><a href='#L608'>608</a>
<a name='L609'></a><a href='#L609'>609</a>
<a name='L610'></a><a href='#L610'>610</a>
<a name='L611'></a><a href='#L611'>611</a>
<a name='L612'></a><a href='#L612'>612</a>
<a name='L613'></a><a href='#L613'>613</a>
<a name='L614'></a><a href='#L614'>614</a>
<a name='L615'></a><a href='#L615'>615</a>
<a name='L616'></a><a href='#L616'>616</a>
<a name='L617'></a><a href='#L617'>617</a>
<a name='L618'></a><a href='#L618'>618</a>
<a name='L619'></a><a href='#L619'>619</a>
<a name='L620'></a><a href='#L620'>620</a>
<a name='L621'></a><a href='#L621'>621</a>
<a name='L622'></a><a href='#L622'>622</a>
<a name='L623'></a><a href='#L623'>623</a>
<a name='L624'></a><a href='#L624'>624</a>
<a name='L625'></a><a href='#L625'>625</a>
<a name='L626'></a><a href='#L626'>626</a>
<a name='L627'></a><a href='#L627'>627</a>
<a name='L628'></a><a href='#L628'>628</a>
<a name='L629'></a><a href='#L629'>629</a>
<a name='L630'></a><a href='#L630'>630</a>
<a name='L631'></a><a href='#L631'>631</a>
<a name='L632'></a><a href='#L632'>632</a>
<a name='L633'></a><a href='#L633'>633</a>
<a name='L634'></a><a href='#L634'>634</a>
<a name='L635'></a><a href='#L635'>635</a>
<a name='L636'></a><a href='#L636'>636</a>
<a name='L637'></a><a href='#L637'>637</a>
<a name='L638'></a><a href='#L638'>638</a>
<a name='L639'></a><a href='#L639'>639</a>
<a name='L640'></a><a href='#L640'>640</a>
<a name='L641'></a><a href='#L641'>641</a>
<a name='L642'></a><a href='#L642'>642</a>
<a name='L643'></a><a href='#L643'>643</a>
<a name='L644'></a><a href='#L644'>644</a>
<a name='L645'></a><a href='#L645'>645</a>
<a name='L646'></a><a href='#L646'>646</a>
<a name='L647'></a><a href='#L647'>647</a>
<a name='L648'></a><a href='#L648'>648</a>
<a name='L649'></a><a href='#L649'>649</a>
<a name='L650'></a><a href='#L650'>650</a>
<a name='L651'></a><a href='#L651'>651</a>
<a name='L652'></a><a href='#L652'>652</a>
<a name='L653'></a><a href='#L653'>653</a>
<a name='L654'></a><a href='#L654'>654</a>
<a name='L655'></a><a href='#L655'>655</a>
<a name='L656'></a><a href='#L656'>656</a>
<a name='L657'></a><a href='#L657'>657</a>
<a name='L658'></a><a href='#L658'>658</a>
<a name='L659'></a><a href='#L659'>659</a>
<a name='L660'></a><a href='#L660'>660</a>
<a name='L661'></a><a href='#L661'>661</a>
<a name='L662'></a><a href='#L662'>662</a>
<a name='L663'></a><a href='#L663'>663</a>
<a name='L664'></a><a href='#L664'>664</a>
<a name='L665'></a><a href='#L665'>665</a>
<a name='L666'></a><a href='#L666'>666</a>
<a name='L667'></a><a href='#L667'>667</a>
<a name='L668'></a><a href='#L668'>668</a>
<a name='L669'></a><a href='#L669'>669</a>
<a name='L670'></a><a href='#L670'>670</a>
<a name='L671'></a><a href='#L671'>671</a>
<a name='L672'></a><a href='#L672'>672</a>
<a name='L673'></a><a href='#L673'>673</a>
<a name='L674'></a><a href='#L674'>674</a>
<a name='L675'></a><a href='#L675'>675</a>
<a name='L676'></a><a href='#L676'>676</a>
<a name='L677'></a><a href='#L677'>677</a>
<a name='L678'></a><a href='#L678'>678</a>
<a name='L679'></a><a href='#L679'>679</a>
<a name='L680'></a><a href='#L680'>680</a>
<a name='L681'></a><a href='#L681'>681</a>
<a name='L682'></a><a href='#L682'>682</a>
<a name='L683'></a><a href='#L683'>683</a>
<a name='L684'></a><a href='#L684'>684</a>
<a name='L685'></a><a href='#L685'>685</a>
<a name='L686'></a><a href='#L686'>686</a>
<a name='L687'></a><a href='#L687'>687</a>
<a name='L688'></a><a href='#L688'>688</a>
<a name='L689'></a><a href='#L689'>689</a>
<a name='L690'></a><a href='#L690'>690</a>
<a name='L691'></a><a href='#L691'>691</a>
<a name='L692'></a><a href='#L692'>692</a>
<a name='L693'></a><a href='#L693'>693</a>
<a name='L694'></a><a href='#L694'>694</a>
<a name='L695'></a><a href='#L695'>695</a>
<a name='L696'></a><a href='#L696'>696</a>
<a name='L697'></a><a href='#L697'>697</a>
<a name='L698'></a><a href='#L698'>698</a>
<a name='L699'></a><a href='#L699'>699</a>
<a name='L700'></a><a href='#L700'>700</a>
<a name='L701'></a><a href='#L701'>701</a>
<a name='L702'></a><a href='#L702'>702</a>
<a name='L703'></a><a href='#L703'>703</a>
<a name='L704'></a><a href='#L704'>704</a>
<a name='L705'></a><a href='#L705'>705</a>
<a name='L706'></a><a href='#L706'>706</a>
<a name='L707'></a><a href='#L707'>707</a>
<a name='L708'></a><a href='#L708'>708</a>
<a name='L709'></a><a href='#L709'>709</a>
<a name='L710'></a><a href='#L710'>710</a>
<a name='L711'></a><a href='#L711'>711</a>
<a name='L712'></a><a href='#L712'>712</a>
<a name='L713'></a><a href='#L713'>713</a>
<a name='L714'></a><a href='#L714'>714</a>
<a name='L715'></a><a href='#L715'>715</a>
<a name='L716'></a><a href='#L716'>716</a>
<a name='L717'></a><a href='#L717'>717</a>
<a name='L718'></a><a href='#L718'>718</a>
<a name='L719'></a><a href='#L719'>719</a>
<a name='L720'></a><a href='#L720'>720</a>
<a name='L721'></a><a href='#L721'>721</a>
<a name='L722'></a><a href='#L722'>722</a>
<a name='L723'></a><a href='#L723'>723</a>
<a name='L724'></a><a href='#L724'>724</a>
<a name='L725'></a><a href='#L725'>725</a>
<a name='L726'></a><a href='#L726'>726</a>
<a name='L727'></a><a href='#L727'>727</a>
<a name='L728'></a><a href='#L728'>728</a>
<a name='L729'></a><a href='#L729'>729</a>
<a name='L730'></a><a href='#L730'>730</a>
<a name='L731'></a><a href='#L731'>731</a>
<a name='L732'></a><a href='#L732'>732</a>
<a name='L733'></a><a href='#L733'>733</a>
<a name='L734'></a><a href='#L734'>734</a>
<a name='L735'></a><a href='#L735'>735</a>
<a name='L736'></a><a href='#L736'>736</a>
<a name='L737'></a><a href='#L737'>737</a>
<a name='L738'></a><a href='#L738'>738</a>
<a name='L739'></a><a href='#L739'>739</a>
<a name='L740'></a><a href='#L740'>740</a>
<a name='L741'></a><a href='#L741'>741</a>
<a name='L742'></a><a href='#L742'>742</a>
<a name='L743'></a><a href='#L743'>743</a>
<a name='L744'></a><a href='#L744'>744</a>
<a name='L745'></a><a href='#L745'>745</a>
<a name='L746'></a><a href='#L746'>746</a>
<a name='L747'></a><a href='#L747'>747</a>
<a name='L748'></a><a href='#L748'>748</a>
<a name='L749'></a><a href='#L749'>749</a>
<a name='L750'></a><a href='#L750'>750</a>
<a name='L751'></a><a href='#L751'>751</a>
<a name='L752'></a><a href='#L752'>752</a>
<a name='L753'></a><a href='#L753'>753</a>
<a name='L754'></a><a href='#L754'>754</a>
<a name='L755'></a><a href='#L755'>755</a>
<a name='L756'></a><a href='#L756'>756</a>
<a name='L757'></a><a href='#L757'>757</a>
<a name='L758'></a><a href='#L758'>758</a>
<a name='L759'></a><a href='#L759'>759</a>
<a name='L760'></a><a href='#L760'>760</a>
<a name='L761'></a><a href='#L761'>761</a>
<a name='L762'></a><a href='#L762'>762</a>
<a name='L763'></a><a href='#L763'>763</a>
<a name='L764'></a><a href='#L764'>764</a>
<a name='L765'></a><a href='#L765'>765</a>
<a name='L766'></a><a href='#L766'>766</a>
<a name='L767'></a><a href='#L767'>767</a>
<a name='L768'></a><a href='#L768'>768</a>
<a name='L769'></a><a href='#L769'>769</a>
<a name='L770'></a><a href='#L770'>770</a>
<a name='L771'></a><a href='#L771'>771</a>
<a name='L772'></a><a href='#L772'>772</a>
<a name='L773'></a><a href='#L773'>773</a>
<a name='L774'></a><a href='#L774'>774</a>
<a name='L775'></a><a href='#L775'>775</a>
<a name='L776'></a><a href='#L776'>776</a>
<a name='L777'></a><a href='#L777'>777</a>
<a name='L778'></a><a href='#L778'>778</a>
<a name='L779'></a><a href='#L779'>779</a>
<a name='L780'></a><a href='#L780'>780</a>
<a name='L781'></a><a href='#L781'>781</a>
<a name='L782'></a><a href='#L782'>782</a>
<a name='L783'></a><a href='#L783'>783</a>
<a name='L784'></a><a href='#L784'>784</a>
<a name='L785'></a><a href='#L785'>785</a>
<a name='L786'></a><a href='#L786'>786</a>
<a name='L787'></a><a href='#L787'>787</a>
<a name='L788'></a><a href='#L788'>788</a>
<a name='L789'></a><a href='#L789'>789</a>
<a name='L790'></a><a href='#L790'>790</a>
<a name='L791'></a><a href='#L791'>791</a>
<a name='L792'></a><a href='#L792'>792</a>
<a name='L793'></a><a href='#L793'>793</a>
<a name='L794'></a><a href='#L794'>794</a>
<a name='L795'></a><a href='#L795'>795</a>
<a name='L796'></a><a href='#L796'>796</a>
<a name='L797'></a><a href='#L797'>797</a>
<a name='L798'></a><a href='#L798'>798</a>
<a name='L799'></a><a href='#L799'>799</a>
<a name='L800'></a><a href='#L800'>800</a>
<a name='L801'></a><a href='#L801'>801</a>
<a name='L802'></a><a href='#L802'>802</a>
<a name='L803'></a><a href='#L803'>803</a>
<a name='L804'></a><a href='#L804'>804</a>
<a name='L805'></a><a href='#L805'>805</a>
<a name='L806'></a><a href='#L806'>806</a>
<a name='L807'></a><a href='#L807'>807</a>
<a name='L808'></a><a href='#L808'>808</a>
<a name='L809'></a><a href='#L809'>809</a>
<a name='L810'></a><a href='#L810'>810</a>
<a name='L811'></a><a href='#L811'>811</a>
<a name='L812'></a><a href='#L812'>812</a>
<a name='L813'></a><a href='#L813'>813</a>
<a name='L814'></a><a href='#L814'>814</a>
<a name='L815'></a><a href='#L815'>815</a>
<a name='L816'></a><a href='#L816'>816</a>
<a name='L817'></a><a href='#L817'>817</a>
<a name='L818'></a><a href='#L818'>818</a>
<a name='L819'></a><a href='#L819'>819</a>
<a name='L820'></a><a href='#L820'>820</a>
<a name='L821'></a><a href='#L821'>821</a>
<a name='L822'></a><a href='#L822'>822</a>
<a name='L823'></a><a href='#L823'>823</a>
<a name='L824'></a><a href='#L824'>824</a>
<a name='L825'></a><a href='#L825'>825</a>
<a name='L826'></a><a href='#L826'>826</a>
<a name='L827'></a><a href='#L827'>827</a>
<a name='L828'></a><a href='#L828'>828</a>
<a name='L829'></a><a href='#L829'>829</a>
<a name='L830'></a><a href='#L830'>830</a>
<a name='L831'></a><a href='#L831'>831</a>
<a name='L832'></a><a href='#L832'>832</a>
<a name='L833'></a><a href='#L833'>833</a>
<a name='L834'></a><a href='#L834'>834</a>
<a name='L835'></a><a href='#L835'>835</a>
<a name='L836'></a><a href='#L836'>836</a>
<a name='L837'></a><a href='#L837'>837</a>
<a name='L838'></a><a href='#L838'>838</a>
<a name='L839'></a><a href='#L839'>839</a>
<a name='L840'></a><a href='#L840'>840</a>
<a name='L841'></a><a href='#L841'>841</a>
<a name='L842'></a><a href='#L842'>842</a>
<a name='L843'></a><a href='#L843'>843</a>
<a name='L844'></a><a href='#L844'>844</a>
<a name='L845'></a><a href='#L845'>845</a>
<a name='L846'></a><a href='#L846'>846</a>
<a name='L847'></a><a href='#L847'>847</a>
<a name='L848'></a><a href='#L848'>848</a>
<a name='L849'></a><a href='#L849'>849</a>
<a name='L850'></a><a href='#L850'>850</a>
<a name='L851'></a><a href='#L851'>851</a>
<a name='L852'></a><a href='#L852'>852</a>
<a name='L853'></a><a href='#L853'>853</a>
<a name='L854'></a><a href='#L854'>854</a>
<a name='L855'></a><a href='#L855'>855</a>
<a name='L856'></a><a href='#L856'>856</a>
<a name='L857'></a><a href='#L857'>857</a>
<a name='L858'></a><a href='#L858'>858</a>
<a name='L859'></a><a href='#L859'>859</a>
<a name='L860'></a><a href='#L860'>860</a>
<a name='L861'></a><a href='#L861'>861</a>
<a name='L862'></a><a href='#L862'>862</a>
<a name='L863'></a><a href='#L863'>863</a>
<a name='L864'></a><a href='#L864'>864</a>
<a name='L865'></a><a href='#L865'>865</a>
<a name='L866'></a><a href='#L866'>866</a>
<a name='L867'></a><a href='#L867'>867</a>
<a name='L868'></a><a href='#L868'>868</a>
<a name='L869'></a><a href='#L869'>869</a>
<a name='L870'></a><a href='#L870'>870</a>
<a name='L871'></a><a href='#L871'>871</a>
<a name='L872'></a><a href='#L872'>872</a>
<a name='L873'></a><a href='#L873'>873</a>
<a name='L874'></a><a href='#L874'>874</a>
<a name='L875'></a><a href='#L875'>875</a>
<a name='L876'></a><a href='#L876'>876</a>
<a name='L877'></a><a href='#L877'>877</a>
<a name='L878'></a><a href='#L878'>878</a>
<a name='L879'></a><a href='#L879'>879</a>
<a name='L880'></a><a href='#L880'>880</a>
<a name='L881'></a><a href='#L881'>881</a>
<a name='L882'></a><a href='#L882'>882</a>
<a name='L883'></a><a href='#L883'>883</a>
<a name='L884'></a><a href='#L884'>884</a>
<a name='L885'></a><a href='#L885'>885</a>
<a name='L886'></a><a href='#L886'>886</a>
<a name='L887'></a><a href='#L887'>887</a>
<a name='L888'></a><a href='#L888'>888</a>
<a name='L889'></a><a href='#L889'>889</a>
<a name='L890'></a><a href='#L890'>890</a>
<a name='L891'></a><a href='#L891'>891</a>
<a name='L892'></a><a href='#L892'>892</a>
<a name='L893'></a><a href='#L893'>893</a>
<a name='L894'></a><a href='#L894'>894</a>
<a name='L895'></a><a href='#L895'>895</a>
<a name='L896'></a><a href='#L896'>896</a>
<a name='L897'></a><a href='#L897'>897</a>
<a name='L898'></a><a href='#L898'>898</a>
<a name='L899'></a><a href='#L899'>899</a>
<a name='L900'></a><a href='#L900'>900</a>
<a name='L901'></a><a href='#L901'>901</a>
<a name='L902'></a><a href='#L902'>902</a>
<a name='L903'></a><a href='#L903'>903</a>
<a name='L904'></a><a href='#L904'>904</a>
<a name='L905'></a><a href='#L905'>905</a>
<a name='L906'></a><a href='#L906'>906</a>
<a name='L907'></a><a href='#L907'>907</a>
<a name='L908'></a><a href='#L908'>908</a>
<a name='L909'></a><a href='#L909'>909</a>
<a name='L910'></a><a href='#L910'>910</a>
<a name='L911'></a><a href='#L911'>911</a>
<a name='L912'></a><a href='#L912'>912</a>
<a name='L913'></a><a href='#L913'>913</a>
<a name='L914'></a><a href='#L914'>914</a>
<a name='L915'></a><a href='#L915'>915</a>
<a name='L916'></a><a href='#L916'>916</a>
<a name='L917'></a><a href='#L917'>917</a>
<a name='L918'></a><a href='#L918'>918</a>
<a name='L919'></a><a href='#L919'>919</a>
<a name='L920'></a><a href='#L920'>920</a>
<a name='L921'></a><a href='#L921'>921</a>
<a name='L922'></a><a href='#L922'>922</a>
<a name='L923'></a><a href='#L923'>923</a>
<a name='L924'></a><a href='#L924'>924</a>
<a name='L925'></a><a href='#L925'>925</a>
<a name='L926'></a><a href='#L926'>926</a>
<a name='L927'></a><a href='#L927'>927</a>
<a name='L928'></a><a href='#L928'>928</a>
<a name='L929'></a><a href='#L929'>929</a>
<a name='L930'></a><a href='#L930'>930</a>
<a name='L931'></a><a href='#L931'>931</a>
<a name='L932'></a><a href='#L932'>932</a>
<a name='L933'></a><a href='#L933'>933</a>
<a name='L934'></a><a href='#L934'>934</a>
<a name='L935'></a><a href='#L935'>935</a>
<a name='L936'></a><a href='#L936'>936</a>
<a name='L937'></a><a href='#L937'>937</a>
<a name='L938'></a><a href='#L938'>938</a>
<a name='L939'></a><a href='#L939'>939</a>
<a name='L940'></a><a href='#L940'>940</a>
<a name='L941'></a><a href='#L941'>941</a>
<a name='L942'></a><a href='#L942'>942</a>
<a name='L943'></a><a href='#L943'>943</a>
<a name='L944'></a><a href='#L944'>944</a>
<a name='L945'></a><a href='#L945'>945</a>
<a name='L946'></a><a href='#L946'>946</a>
<a name='L947'></a><a href='#L947'>947</a>
<a name='L948'></a><a href='#L948'>948</a>
<a name='L949'></a><a href='#L949'>949</a>
<a name='L950'></a><a href='#L950'>950</a>
<a name='L951'></a><a href='#L951'>951</a>
<a name='L952'></a><a href='#L952'>952</a>
<a name='L953'></a><a href='#L953'>953</a>
<a name='L954'></a><a href='#L954'>954</a>
<a name='L955'></a><a href='#L955'>955</a>
<a name='L956'></a><a href='#L956'>956</a>
<a name='L957'></a><a href='#L957'>957</a>
<a name='L958'></a><a href='#L958'>958</a>
<a name='L959'></a><a href='#L959'>959</a>
<a name='L960'></a><a href='#L960'>960</a>
<a name='L961'></a><a href='#L961'>961</a>
<a name='L962'></a><a href='#L962'>962</a>
<a name='L963'></a><a href='#L963'>963</a>
<a name='L964'></a><a href='#L964'>964</a>
<a name='L965'></a><a href='#L965'>965</a>
<a name='L966'></a><a href='#L966'>966</a>
<a name='L967'></a><a href='#L967'>967</a>
<a name='L968'></a><a href='#L968'>968</a>
<a name='L969'></a><a href='#L969'>969</a>
<a name='L970'></a><a href='#L970'>970</a>
<a name='L971'></a><a href='#L971'>971</a>
<a name='L972'></a><a href='#L972'>972</a>
<a name='L973'></a><a href='#L973'>973</a>
<a name='L974'></a><a href='#L974'>974</a>
<a name='L975'></a><a href='#L975'>975</a>
<a name='L976'></a><a href='#L976'>976</a>
<a name='L977'></a><a href='#L977'>977</a>
<a name='L978'></a><a href='#L978'>978</a>
<a name='L979'></a><a href='#L979'>979</a>
<a name='L980'></a><a href='#L980'>980</a>
<a name='L981'></a><a href='#L981'>981</a>
<a name='L982'></a><a href='#L982'>982</a>
<a name='L983'></a><a href='#L983'>983</a>
<a name='L984'></a><a href='#L984'>984</a></td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// userServices.js
import Rating from "../models/ratings.js";
import bcrypt from "bcryptjs";
import jwt from "jsonwebtoken";
import User from "../models/users.js";
import mongoose from "mongoose";
import Chart from "../models/charts.js";
import dotenv from "dotenv";
import Center from "../models/centers.js";
import Booking from "../models/bookings.js";
import { checkEmailExistsService, updateAvgRating, sendEmailService, checkEmailUniqueness } from "../middleware/userMiddleware.js";
import path from "path";
import fs from "fs/promises";
import crypto from "crypto";
&nbsp;
// Load environment variables from .env file
<span class="cstat-no" title="statement not covered" >dotenv.config();</span>
&nbsp;
// Constants for level calculation
const levels = <span class="cstat-no" title="statement not covered" >["Sắt", "Đồng", "Bạc", "Vàng", "Bạch kim"];</span>
const pointsPerLevel = <span class="cstat-no" title="statement not covered" >1000;</span>
&nbsp;
const MAX_FAILED_ATTEMPTS = <span class="cstat-no" title="statement not covered" >5;</span>
const LOCK_TIME = <span class="cstat-no" title="statement not covered" >10 * 60 * 1000;</span> // 10 phút tính bằng mili giây
&nbsp;
const FORBIDDEN_WORDS = <span class="cstat-no" title="statement not covered" >[</span>
    "đm", "đmm", "vcl", "vl", "đ*t", "d*t", "địt", "dịt", "l*n", "lon", "lồn", "c*c", "cac", "cặc",
    "ngu", "ngu ngốc", "đần", "khốn nạn", "khốn kiếp", "chó", "con chó", "mẹ mày", "bố mày",
    "thằng ngu", "con điên", "đồ ngu", "đồ điên", "súc vật", "đê tiện", "hèn hạ", "lừa đảo", "đồ đểu", "djt",
    // Thêm các từ khác nếu cần
];
&nbsp;
// Hàm kiểm tra từ không cho phép
const containsForbiddenWords = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >(t</span>ext) =&gt; {</span>
    const lowerText = <span class="cstat-no" title="statement not covered" >text.toLowerCase();</span>
<span class="cstat-no" title="statement not covered" >    return FORBIDDEN_WORDS.some(<span class="fstat-no" title="function not covered" >wo</span>rd =&gt; <span class="cstat-no" title="statement not covered" >lowerText.includes(word))</span>;</span>
};
&nbsp;
/**
 * Đăng ký user mới
 */
export const registerUserService = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userData) =&gt; {</span>
    const { name, email, phone_number, username, password, avatar_image_path } = <span class="cstat-no" title="statement not covered" >userData;</span>
    const errors = <span class="cstat-no" title="statement not covered" >{};</span>
&nbsp;
    // Validate input fields
<span class="cstat-no" title="statement not covered" >    if (!name || !name.trim()) <span class="cstat-no" title="statement not covered" >errors.name = "Vui lòng nhập Họ và tên";</span></span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!email || !email.trim()) {</span>
<span class="cstat-no" title="statement not covered" >        errors.email = "Vui lòng nhập Email";</span>
    } else <span class="cstat-no" title="statement not covered" >if (!/^\S+@\S+\.\S+$/.test(email)) {</span>
<span class="cstat-no" title="statement not covered" >        errors.email = "Email không hợp lệ";</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!phone_number || !phone_number.trim()) {</span>
<span class="cstat-no" title="statement not covered" >        errors.phone_number = "Vui lòng nhập Số điện thoại";</span>
    } else {
        const validPrefixes = <span class="cstat-no" title="statement not covered" >[</span>
            "032", "033", "034", "035", "036", "037", "038", "039",
            "055", "056", "057", "058", "059",
            "070", "076", "077", "078", "079",
            "081", "082", "083", "084", "085", "086", "087", "088", "089",
            "090", "091", "092", "093", "094", "095", "096", "097", "098", "099"
        ];
        let isValidPhone = <span class="cstat-no" title="statement not covered" >false;</span>
        let phoneError = <span class="cstat-no" title="statement not covered" >"Số điện thoại không hợp lệ!";</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (phone_number.startsWith("+84")) {</span>
            const phoneWithoutPrefix = <span class="cstat-no" title="statement not covered" >phone_number.slice(3);</span>
<span class="cstat-no" title="statement not covered" >            if (/^\d{9}$/.test(phoneWithoutPrefix)) {</span>
                const mobilePrefix = <span class="cstat-no" title="statement not covered" >phoneWithoutPrefix.slice(0, 3);</span>
<span class="cstat-no" title="statement not covered" >                if (validPrefixes.includes("0" + mobilePrefix)) {</span>
<span class="cstat-no" title="statement not covered" >                    isValidPhone = true;</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    phoneError = "Đầu số không hợp lệ!";</span>
                }
            }
        } else <span class="cstat-no" title="statement not covered" >if (phone_number.startsWith("0")) {</span>
<span class="cstat-no" title="statement not covered" >            if (/^\d{10}$/.test(phone_number)) {</span>
                const mobilePrefix = <span class="cstat-no" title="statement not covered" >phone_number.slice(0, 3);</span>
<span class="cstat-no" title="statement not covered" >                if (validPrefixes.includes(mobilePrefix)) {</span>
<span class="cstat-no" title="statement not covered" >                    isValidPhone = true;</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    phoneError = "Đầu số không hợp lệ!";</span>
                }
            }
        } else {
<span class="cstat-no" title="statement not covered" >            phoneError = "Số điện thoại phải bắt đầu bằng 0 hoặc +84!";</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (!isValidPhone) {</span>
<span class="cstat-no" title="statement not covered" >            errors.phone_number = phoneError;</span>
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!username || !username.trim()) {</span>
<span class="cstat-no" title="statement not covered" >        errors.username = "Vui lòng nhập Tên đăng nhập";</span>
    } else <span class="cstat-no" title="statement not covered" >if (/\s/.test(username)) {</span>
<span class="cstat-no" title="statement not covered" >        errors.username = "Tên đăng nhập không được chứa khoảng trắng!";</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!password) {</span>
<span class="cstat-no" title="statement not covered" >        errors.password = "Vui lòng nhập Mật khẩu";</span>
    } else {
        const isInvalidPassword = (
<span class="cstat-no" title="statement not covered" >            password.length &lt; 8 ||</span>
            !/[A-Z]/.test(password) ||
            !/[a-z]/.test(password) ||
            !/[0-9]/.test(password) ||
            !/[!@#$%^&amp;*(),.?":{}|&lt;&gt;]/.test(password)
        );
<span class="cstat-no" title="statement not covered" >        if (isInvalidPassword) {</span>
<span class="cstat-no" title="statement not covered" >            errors.password = "Mật khẩu cần có độ dài tối thiểu 8 ký tự, bao gồm chữ hoa, chữ thường, số và ký tự đặc biệt.";</span>
        }
    }
&nbsp;
    // Combine existence checks into a single query for efficiency
    const existingUsers = <span class="cstat-no" title="statement not covered" >await User.find({</span>
        $or: [
            { email: email },
            { phone_number: phone_number },
            { username: username }
        ]
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    existingUsers.forEach(<span class="fstat-no" title="function not covered" >us</span>er =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        if (user.email === email) <span class="cstat-no" title="statement not covered" >errors.email = "Email đã được sử dụng!";</span></span>
<span class="cstat-no" title="statement not covered" >        if (user.phone_number === phone_number) <span class="cstat-no" title="statement not covered" >errors.phone_number = "Số điện thoại đã được sử dụng!";</span></span>
<span class="cstat-no" title="statement not covered" >        if (user.username === username) <span class="cstat-no" title="statement not covered" >errors.username = "Tên đăng nhập đã được sử dụng!";</span></span>
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (Object.keys(errors).length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >        throw { status: 400, errors };</span>
    }
    
    const salt = <span class="cstat-no" title="statement not covered" >await bcrypt.genSalt(10);</span>
    const hashedPassword = <span class="cstat-no" title="statement not covered" >await bcrypt.hash(password, salt);</span>
&nbsp;
    const user = <span class="cstat-no" title="statement not covered" >await User.create({</span>
        name,
        email,
        phone_number,
        username,
        password_hash: hashedPassword,
        avatar_image_path: avatar_image_path || ""
    });
<span class="cstat-no" title="statement not covered" >    return user;</span>
};
&nbsp;
/**
 * Đăng nhập user
 */
export const loginUserService = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (username, password) =&gt; {</span>
    const user = <span class="cstat-no" title="statement not covered" >await User.findOne({ username }).select("+password_hash +failed_login_attempts +lock_until");</span>
    
<span class="cstat-no" title="statement not covered" >    if (!user) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("User không tồn tại!");</span>
    }
&nbsp;
    // 1. Kiểm tra tài khoản có đang bị khóa không
<span class="cstat-no" title="statement not covered" >    if (user.lock_until &amp;&amp; user.lock_until &gt; new Date()) {</span>
        const remainingLockTimeSeconds = <span class="cstat-no" title="statement not covered" >Math.ceil((user.lock_until.getTime() - new Date().getTime()) / 1000);</span>
        const minutes = <span class="cstat-no" title="statement not covered" >Math.floor(remainingLockTimeSeconds / 60);</span>
        const seconds = <span class="cstat-no" title="statement not covered" >remainingLockTimeSeconds % 60;</span>
<span class="cstat-no" title="statement not covered" >        throw new Error(`Tài khoản của bạn đã bị khóa. Vui lòng thử lại sau ${minutes} phút ${seconds} giây.`);</span>
    }
&nbsp;
    const isPasswordValid = <span class="cstat-no" title="statement not covered" >await bcrypt.compare(password, user.password_hash);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!isPasswordValid) {</span>
        // 2. Tăng số lần đăng nhập sai
<span class="cstat-no" title="statement not covered" >        user.failed_login_attempts += 1;</span>
&nbsp;
        // 3. Kiểm tra nếu số lần sai vượt ngưỡng
<span class="cstat-no" title="statement not covered" >        if (user.failed_login_attempts &gt;= MAX_FAILED_ATTEMPTS) {</span>
<span class="cstat-no" title="statement not covered" >            user.lock_until = new Date(Date.now() + LOCK_TIME); </span>// Khóa tài khoản
<span class="cstat-no" title="statement not covered" >            user.failed_login_attempts = 0; </span>// Reset số lần sai khi đã khóa
<span class="cstat-no" title="statement not covered" >            await user.save();</span>
<span class="cstat-no" title="statement not covered" >            throw new Error(`Bạn đã nhập sai mật khẩu quá ${MAX_FAILED_ATTEMPTS} lần. Tài khoản của bạn đã bị khóa trong 10 phút.`);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            await user.save();</span>
            const remainingAttempts = <span class="cstat-no" title="statement not covered" >MAX_FAILED_ATTEMPTS - user.failed_login_attempts;</span>
<span class="cstat-no" title="statement not covered" >            throw new Error(`Sai mật khẩu! Bạn còn ${remainingAttempts} lần thử trước khi tài khoản bị khóa.`);</span>
        }
    }
&nbsp;
    // 4. Đăng nhập thành công: Reset số lần đăng nhập sai và thời gian khóa
<span class="cstat-no" title="statement not covered" >    user.failed_login_attempts = 0;</span>
<span class="cstat-no" title="statement not covered" >    user.lock_until = null;</span>
<span class="cstat-no" title="statement not covered" >    await user.save();</span>
&nbsp;
    const token = <span class="cstat-no" title="statement not covered" >jwt.sign(</span>
        { id: user._id, type: "user" },
        process.env.JWT_SECRET,
        { expiresIn: "30d" }
    );
    
    // Convert Mongoose document to plain object and remove password_hash
    const userObj = <span class="cstat-no" title="statement not covered" >user.toObject();</span>
<span class="cstat-no" title="statement not covered" >    delete userObj.password_hash; </span>// Xóa trường password_hash khỏi object trả về
&nbsp;
<span class="cstat-no" title="statement not covered" >    return { token, user: userObj };</span>
};
&nbsp;
/**
 * Cập nhật thông tin user
 */
export const updateUserService = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId, payload) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
      const user = <span class="cstat-no" title="statement not covered" >await User.findById(userId);</span>
<span class="cstat-no" title="statement not covered" >      if (!user) {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Không tìm thấy người dùng!");</span>
      }
  
      // If updating email, validate it
<span class="cstat-no" title="statement not covered" >      if (payload.email &amp;&amp; payload.email !== user.email) { // Only validate if email is changed</span>
        // Check email format and existence
        const emailCheck = <span class="cstat-no" title="statement not covered" >await checkEmailExistsService(payload.email);</span>
<span class="cstat-no" title="statement not covered" >        if (!emailCheck.success) {</span>
<span class="cstat-no" title="statement not covered" >          throw new Error(emailCheck.message);</span>
        }
  
        // Check email uniqueness
        const uniquenessCheck = <span class="cstat-no" title="statement not covered" >await checkEmailUniqueness(payload.email, userId);</span>
<span class="cstat-no" title="statement not covered" >        if (!uniquenessCheck.success) {</span>
<span class="cstat-no" title="statement not covered" >          throw new Error(uniquenessCheck.message);</span>
        }
      }
  
      // Delete old avatar if updating avatar_image_path
      // Use __dirname for path resolution consistently
      const currentDir = <span class="cstat-no" title="statement not covered" >process.cwd();</span> // Get current working directory
<span class="cstat-no" title="statement not covered" >      if (payload.avatar_image_path &amp;&amp; user.avatar_image_path &amp;&amp; payload.avatar_image_path !== user.avatar_image_path) {</span>
        const oldPath = <span class="cstat-no" title="statement not covered" >path.join(currentDir, user.avatar_image_path);</span>
<span class="cstat-no" title="statement not covered" >        try {</span>
<span class="cstat-no" title="statement not covered" >          await fs.access(oldPath); </span>// Check if file exists
<span class="cstat-no" title="statement not covered" >          await fs.unlink(oldPath); </span>// Delete file asynchronously
<span class="cstat-no" title="statement not covered" >          console.log(`Đã xóa ảnh cũ tại: ${oldPath}`);</span>
        } catch (error) {
<span class="cstat-no" title="statement not covered" >          if (error.code !== "ENOENT") { // Ignore if file not found</span>
<span class="cstat-no" title="statement not covered" >            console.error(`Lỗi khi xóa ảnh cũ tại ${oldPath}:`, error);</span>
          }
        }
      }
  
      // Update user
      const updatedUser = <span class="cstat-no" title="statement not covered" >await User.findOneAndUpdate(</span>
        { _id: userId },
        { $set: payload },
        { new: true }
      );
  
      // Remove password_hash before returning
      const userObject = <span class="cstat-no" title="statement not covered" >updatedUser.toObject();</span>
<span class="cstat-no" title="statement not covered" >      delete userObject.password_hash;</span>
  
<span class="cstat-no" title="statement not covered" >      return userObject;</span>
    } catch (error) {
<span class="cstat-no" title="statement not covered" >      throw error;</span>
    }
  };
&nbsp;
/**
 * Cập nhật mật khẩu user
 */
export const updateUserPasswordService = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (user, oldPassword, newPassword) =&gt; {</span>
    const isMatch = <span class="cstat-no" title="statement not covered" >await bcrypt.compare(oldPassword, user.password_hash);</span>
<span class="cstat-no" title="statement not covered" >    if (!isMatch) {</span>
<span class="cstat-no" title="statement not covered" >      throw new Error("Mật khẩu cũ không chính xác");</span>
    }
    
    const salt = <span class="cstat-no" title="statement not covered" >await bcrypt.genSalt(10);</span>
    const hashedPassword = <span class="cstat-no" title="statement not covered" >await bcrypt.hash(newPassword, salt);</span>
<span class="cstat-no" title="statement not covered" >    user.password_hash = hashedPassword;</span>
<span class="cstat-no" title="statement not covered" >    await user.save(); </span>// Save the updated user document
<span class="cstat-no" title="statement not covered" >    return user;</span>
};
&nbsp;
/**
 * Tính và cập nhật level của user dựa trên points
 */
export const updateUserLevel = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
        // Find user and update level in a single operation
        const user = <span class="cstat-no" title="statement not covered" >await User.findById(userId);</span>
<span class="cstat-no" title="statement not covered" >        if (!user) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error("User không tồn tại");</span>
        }
&nbsp;
        const userPoints = <span class="cstat-no" title="statement not covered" >user.points || 0;</span>
        const currentLevelIndex = <span class="cstat-no" title="statement not covered" >Math.min(Math.floor(userPoints / pointsPerLevel), levels.length - 1);</span>
        const currentLevelName = <span class="cstat-no" title="statement not covered" >levels[currentLevelIndex];</span>
&nbsp;
        // Only update if the level has changed
<span class="cstat-no" title="statement not covered" >        if (user.level !== currentLevelName) {</span>
            const updatedUser = <span class="cstat-no" title="statement not covered" >await User.findByIdAndUpdate(</span>
                userId,
                { $set: { level: currentLevelName } },
                { new: true, select: 'level' } // Select only the 'level' field to return
            );
<span class="cstat-no" title="statement not covered" >            console.log(`Cập nhật level cho user ${userId}: ${updatedUser.level}`);</span>
<span class="cstat-no" title="statement not covered" >            return { currentLevelName: updatedUser.level };</span>
        }
        
<span class="cstat-no" title="statement not covered" >        console.log(`Level của user ${userId} không thay đổi: ${user.level}`);</span>
<span class="cstat-no" title="statement not covered" >        return { currentLevelName: user.level }; </span>// Return current level if no update needed
    } catch (error) {
<span class="cstat-no" title="statement not covered" >        console.error("Lỗi khi cập nhật level cho user:", error);</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Có lỗi xảy ra khi cập nhật level user");</span>
    }
};
&nbsp;
/**
 * Cập nhật số lượng completed bookings cho user
 */
export const updateCompletedBookingsForUser = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
        const completedCount = <span class="cstat-no" title="statement not covered" >await Booking.countDocuments({</span>
            userId: new mongoose.Types.ObjectId(userId),
            status: "paid" // Assuming 'status' is the correct field for payment status
        });
<span class="cstat-no" title="statement not covered" >        console.log(`Đếm completed bookings cho user ${userId}: ${completedCount}`);</span>
&nbsp;
        const updatedUser = <span class="cstat-no" title="statement not covered" >await User.findByIdAndUpdate(</span>
            userId,
            { $set: { "stats.completedBookings": completedCount } },
            { new: true, select: 'stats.completedBookings' } // Select only the updated field
        );
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (updatedUser) {</span>
<span class="cstat-no" title="statement not covered" >            console.log(`Cập nhật thành công stats.completedBookings cho user ${userId}: ${updatedUser.stats.completedBookings}`);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            console.log(`Không tìm thấy user ${userId} để cập nhật stats.completedBookings.`);</span>
        }
<span class="cstat-no" title="statement not covered" >        return completedCount;</span>
    } catch (error) {
<span class="cstat-no" title="statement not covered" >        console.error("Error updating completed bookings for user:", error);</span>
<span class="cstat-no" title="statement not covered" >        throw error;</span>
    }
};
&nbsp;
/**
 * Tăng tổng số bookings của user
 */
export const incrementTotalBookings = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId) =&gt; {</span>
    const updatedUser = <span class="cstat-no" title="statement not covered" >await User.findByIdAndUpdate(</span>
        userId,
        { $inc: { "stats.totalBookings": 1 } },
        { new: true, select: 'stats.totalBookings' } // Select only the updated field
    );
<span class="cstat-no" title="statement not covered" >    console.log(`User ${userId} stats.totalBookings được tăng lên thành: ${updatedUser.stats.totalBookings}`);</span>
<span class="cstat-no" title="statement not covered" >    return updatedUser.stats.totalBookings;</span>
};
&nbsp;
/**
 * Đánh dấu booking bị hủy
 */
export const markBookingAsCancelled = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId) =&gt; {</span>
    const updatedUser = <span class="cstat-no" title="statement not covered" >await User.findByIdAndUpdate(</span>
        userId,
        { $inc: { "stats.cancelledBookings": 1 } },
        { new: true, select: 'stats.cancelledBookings' } // Select only the updated field
    );
<span class="cstat-no" title="statement not covered" >    return updatedUser;</span>
};
&nbsp;
/**
 * Cập nhật điểm của user dựa trên totalAmount
 */
export const updateUserPoints = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId, totalAmount) =&gt; {</span>
    let pointsToAdd = <span class="cstat-no" title="statement not covered" >0;</span>
<span class="cstat-no" title="statement not covered" >    if (totalAmount &gt; 100000 &amp;&amp; totalAmount &lt; 200000) {</span>
<span class="cstat-no" title="statement not covered" >        pointsToAdd = 100;</span>
    } else <span class="cstat-no" title="statement not covered" >if (totalAmount &gt;= 200000 &amp;&amp; totalAmount &lt; 300000) {</span>
<span class="cstat-no" title="statement not covered" >        pointsToAdd = 200;</span>
    } else <span class="cstat-no" title="statement not covered" >if (totalAmount &gt;= 300000 &amp;&amp; totalAmount &lt; 400000) {</span>
<span class="cstat-no" title="statement not covered" >        pointsToAdd = 300;</span>
    } else <span class="cstat-no" title="statement not covered" >if (totalAmount &gt;= 400000 &amp;&amp; totalAmount &lt; 500000) {</span>
<span class="cstat-no" title="statement not covered" >        pointsToAdd = 400;</span>
    } else <span class="cstat-no" title="statement not covered" >if (totalAmount &gt;= 500000) {</span>
<span class="cstat-no" title="statement not covered" >        pointsToAdd = 500;</span>
    }
&nbsp;
    const updatedUser = <span class="cstat-no" title="statement not covered" >await User.findByIdAndUpdate(</span>
        userId,
        { $inc: { points: pointsToAdd } },
        { new: true }
    );
<span class="cstat-no" title="statement not covered" >    console.log(</span>
        `User ${userId} được cộng ${pointsToAdd} điểm, tổng điểm mới: ${updatedUser.points}`
    );
&nbsp;
    // Gọi hàm updateUserLevel để cập nhật level sau khi điểm thay đổi
<span class="cstat-no" title="statement not covered" >    await updateUserLevel(userId);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    return { totalPoints: updatedUser.points, pointsEarned: pointsToAdd };</span>
};
&nbsp;
/**
 * Cập nhật số completed cho tháng tương ứng
 */
export const updateChartForCompleted = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId, date = <span class="branch-0 cbranch-no" title="branch not covered" >new Date())</span> =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    if (!(date instanceof Date)) {</span>
<span class="cstat-no" title="statement not covered" >        date = new Date(date);</span>
    }
    const monthNumber = <span class="cstat-no" title="statement not covered" >date.getMonth() + 1;</span>
    const monthKey = <span class="cstat-no" title="statement not covered" >"T" + monthNumber;</span>
&nbsp;
    // Use findOneAndUpdate with upsert to create if not exists and update atomically
    const chartData = <span class="cstat-no" title="statement not covered" >await Chart.findOneAndUpdate(</span>
        { user: userId, "months.month": monthKey },
        { $inc: { "months.$.completed": 1 } }, // Increment 'completed' for the matched month
        { new: true, upsert: true } // Return the updated document, create if not exists
    );
&nbsp;
    // If the month did not exist, or if the document was newly created,
    // we might need to initialize other months.
    // This is a common pattern for chart data, but can be done more efficiently
    // if the defaultMonths array is always expected to be full.
    // For simplicity and to avoid complex aggregation for default,
    // we'll fetch and save if the direct update didn't work as expected (e.g., new user).
<span class="cstat-no" title="statement not covered" >    if (!chartData || !chartData.months.find(<span class="fstat-no" title="function not covered" >m </span>=&gt; <span class="cstat-no" title="statement not covered" >m.month === monthKey)</span>) {</span>
        let existingChart = <span class="cstat-no" title="statement not covered" >await Chart.findOne({ user: userId });</span>
<span class="cstat-no" title="statement not covered" >        if (!existingChart) {</span>
            const defaultMonths = <span class="cstat-no" title="statement not covered" >[];</span>
<span class="cstat-no" title="statement not covered" >            for (let i = <span class="cstat-no" title="statement not covered" >1;</span> i &lt;= 12; i++) {</span>
<span class="cstat-no" title="statement not covered" >                defaultMonths.push({ month: "T" + i, completed: 0, cancelled: 0 });</span>
            }
<span class="cstat-no" title="statement not covered" >            existingChart = new Chart({ user: userId, months: defaultMonths });</span>
        }
        const monthObj = <span class="cstat-no" title="statement not covered" >existingChart.months.find(<span class="fstat-no" title="function not covered" >(m</span>) =&gt; <span class="cstat-no" title="statement not covered" >m.month === monthKey)</span>;</span>
<span class="cstat-no" title="statement not covered" >        if (monthObj) {</span>
<span class="cstat-no" title="statement not covered" >            monthObj.completed += 1;</span>
        }
<span class="cstat-no" title="statement not covered" >        await existingChart.save();</span>
<span class="cstat-no" title="statement not covered" >        return existingChart;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return chartData;</span>
};
&nbsp;
/**
 * Cập nhật số cancelled cho tháng tương ứng
 */
export const updateChartForCancelled = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId, date = <span class="branch-0 cbranch-no" title="branch not covered" >new Date())</span> =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    if (!(date instanceof Date)) {</span>
<span class="cstat-no" title="statement not covered" >        date = new Date(date);</span>
    }
    const monthNumber = <span class="cstat-no" title="statement not covered" >date.getMonth() + 1;</span>
    const monthKey = <span class="cstat-no" title="statement not covered" >"T" + monthNumber;</span>
&nbsp;
    // Use findOneAndUpdate with upsert to create if not exists and update atomically
    const chartData = <span class="cstat-no" title="statement not covered" >await Chart.findOneAndUpdate(</span>
        { user: userId, "months.month": monthKey },
        { $inc: { "months.$.cancelled": 1 } }, // Increment 'cancelled' for the matched month
        { new: true, upsert: true } // Return the updated document, create if not exists
    );
&nbsp;
    // Similar fallback logic as updateChartForCompleted
<span class="cstat-no" title="statement not covered" >    if (!chartData || !chartData.months.find(<span class="fstat-no" title="function not covered" >m </span>=&gt; <span class="cstat-no" title="statement not covered" >m.month === monthKey)</span>) {</span>
        let existingChart = <span class="cstat-no" title="statement not covered" >await Chart.findOne({ user: userId });</span>
<span class="cstat-no" title="statement not covered" >        if (!existingChart) {</span>
            const defaultMonths = <span class="cstat-no" title="statement not covered" >[];</span>
<span class="cstat-no" title="statement not covered" >            for (let i = <span class="cstat-no" title="statement not covered" >1;</span> i &lt;= 12; i++) {</span>
<span class="cstat-no" title="statement not covered" >                defaultMonths.push({ month: "T" + i, completed: 0, cancelled: 0 });</span>
            }
<span class="cstat-no" title="statement not covered" >            existingChart = new Chart({ user: userId, months: defaultMonths });</span>
        }
        const monthObj = <span class="cstat-no" title="statement not covered" >existingChart.months.find(<span class="fstat-no" title="function not covered" >(m</span>) =&gt; <span class="cstat-no" title="statement not covered" >m.month === monthKey)</span>;</span>
<span class="cstat-no" title="statement not covered" >        if (monthObj) {</span>
<span class="cstat-no" title="statement not covered" >            monthObj.cancelled += 1;</span>
        }
<span class="cstat-no" title="statement not covered" >        await existingChart.save();</span>
<span class="cstat-no" title="statement not covered" >        return existingChart;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return chartData;</span>
};
&nbsp;
/**
 * Lấy dữ liệu biểu đồ
 */
export const getChartService = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId) =&gt; {</span>
    const chartData = <span class="cstat-no" title="statement not covered" >await Chart.findOne({ user: userId });</span>
<span class="cstat-no" title="statement not covered" >    if (!chartData) {</span>
        const defaultMonths = <span class="cstat-no" title="statement not covered" >[];</span>
<span class="cstat-no" title="statement not covered" >        for (let i = <span class="cstat-no" title="statement not covered" >1;</span> i &lt;= 12; i++) {</span>
<span class="cstat-no" title="statement not covered" >            defaultMonths.push({ month: "T" + i, completed: 0, cancelled: 0 });</span>
        }
<span class="cstat-no" title="statement not covered" >        return defaultMonths;</span>
    }
<span class="cstat-no" title="statement not covered" >    return chartData.months;</span>
};
&nbsp;
/**
 * So sánh thay đổi giữa hai khoảng thời gian
 */
const compareChange = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >(c</span>urrent, previous) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    if (previous === 0) <span class="cstat-no" title="statement not covered" >return current &gt; 0 ? 100 : 0;</span></span>
<span class="cstat-no" title="statement not covered" >    return parseFloat(((current - previous) / previous) * 100).toFixed(2); </span>// Format to 2 decimal places
};
&nbsp;
/**
 * Lấy thống kê booking của user
 */
export const getUserBookingStats = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId, period = <span class="branch-0 cbranch-no" title="branch not covered" >"month")</span> =&gt; {</span>
    const now = <span class="cstat-no" title="statement not covered" >new Date();</span>
    const currentYear = <span class="cstat-no" title="statement not covered" >now.getUTCFullYear();</span>
    const currentMonth = <span class="cstat-no" title="statement not covered" >now.getUTCMonth();</span>
    const currentDate = <span class="cstat-no" title="statement not covered" >now.getUTCDate();</span>
&nbsp;
    let currentStart, previousStart, previousEnd;
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (period === "week") {</span>
        const dayOfWeek = <span class="cstat-no" title="statement not covered" >now.getUTCDay();</span>
        const diffToMonday = <span class="cstat-no" title="statement not covered" >(dayOfWeek + 6) % 7;</span>
<span class="cstat-no" title="statement not covered" >        currentStart = new Date(Date.UTC(currentYear, currentMonth, currentDate - diffToMonday, 0, 0, 0, 0));</span>
<span class="cstat-no" title="statement not covered" >        previousStart = new Date(Date.UTC(currentYear, currentMonth, currentDate - diffToMonday - 7, 0, 0, 0, 0));</span>
<span class="cstat-no" title="statement not covered" >        previousEnd = new Date(Date.UTC(currentYear, currentMonth, currentDate - diffToMonday - 1, 23, 59, 59, 999));</span>
    } else <span class="cstat-no" title="statement not covered" >if (period === "month") {</span>
<span class="cstat-no" title="statement not covered" >        currentStart = new Date(Date.UTC(currentYear, currentMonth, 1, 0, 0, 0, 0));</span>
<span class="cstat-no" title="statement not covered" >        previousStart = new Date(Date.UTC(currentYear, currentMonth - 1, 1, 0, 0, 0, 0));</span>
<span class="cstat-no" title="statement not covered" >        previousEnd = new Date(Date.UTC(currentYear, currentMonth, 0, 23, 59, 59, 999));</span>
    } else <span class="cstat-no" title="statement not covered" >if (period === "year") {</span>
<span class="cstat-no" title="statement not covered" >        currentStart = new Date(Date.UTC(currentYear, 0, 1, 0, 0, 0, 0));</span>
<span class="cstat-no" title="statement not covered" >        previousStart = new Date(Date.UTC(currentYear - 1, 0, 1, 0, 0, 0, 0));</span>
<span class="cstat-no" title="statement not covered" >        previousEnd = new Date(Date.UTC(currentYear - 1, 11, 31, 23, 59, 59, 999));</span>
    } else {
<span class="cstat-no" title="statement not covered" >        throw new Error("Invalid period parameter. Use 'week', 'month' or 'year'.");</span>
    }
&nbsp;
    // Combine all aggregation queries into a single pipeline using $facet
    const aggregationResult = <span class="cstat-no" title="statement not covered" >await Booking.aggregate([</span>
        {
            $match: {
                userId: new mongoose.Types.ObjectId(userId),
                // Match bookings within both current and previous periods
                createdAt: { $gte: previousStart, $lte: now }
            }
        },
        {
            $facet: {
                "currentPeriodStats": [
                    {
                        $match: {
                            createdAt: { $gte: currentStart, $lte: now }
                        }
                    },
                    {
                        $group: {
                            _id: null,
                            completedCount: { $sum: { $cond: [{ $eq: ["$status", "paid"] }, 1, 0] } },
                            cancelledCount: { $sum: { $cond: [{ $eq: ["$status", "cancelled"] }, 1, 0] } },
                            totalPoints: { $sum: { $cond: [{ $eq: ["$status", "paid"] }, "$pointEarned", 0] } },
                            totalAmount: { $sum: { $cond: [{ $eq: ["$status", "paid"] }, "$totalAmount", 0] } }
                        }
                    }
                ],
                "previousPeriodStats": [
                    {
                        $match: {
                            createdAt: { $gte: previousStart, $lte: previousEnd }
                        }
                    },
                    {
                        $group: {
                            _id: null,
                            completedCount: { $sum: { $cond: [{ $eq: ["$status", "paid"] }, 1, 0] } },
                            cancelledCount: { $sum: { $cond: [{ $eq: ["$status", "cancelled"] }, 1, 0] } },
                            totalPoints: { $sum: { $cond: [{ $eq: ["$status", "paid"] }, "$pointEarned", 0] } },
                            totalAmount: { $sum: { $cond: [{ $eq: ["$status", "paid"] }, "$totalAmount", 0] } }
                        }
                    }
                ]
            }
        }
    ]);
&nbsp;
    // Extract results
    const currentStats = <span class="cstat-no" title="statement not covered" >aggregationResult[0].currentPeriodStats[0] || {};</span>
    const previousStats = <span class="cstat-no" title="statement not covered" >aggregationResult[0].previousPeriodStats[0] || {};</span>
&nbsp;
    const currentCompleted = <span class="cstat-no" title="statement not covered" >currentStats.completedCount || 0;</span>
    const currentCancelled = <span class="cstat-no" title="statement not covered" >currentStats.cancelledCount || 0;</span>
    const currentPoints = <span class="cstat-no" title="statement not covered" >currentStats.totalPoints || 0;</span>
    const currentAmount = <span class="cstat-no" title="statement not covered" >currentStats.totalAmount || 0;</span>
    const currentTotal = <span class="cstat-no" title="statement not covered" >currentCompleted + currentCancelled;</span>
&nbsp;
    const previousCompleted = <span class="cstat-no" title="statement not covered" >previousStats.completedCount || 0;</span>
    const previousCancelled = <span class="cstat-no" title="statement not covered" >previousStats.cancelledCount || 0;</span>
    const previousPoints = <span class="cstat-no" title="statement not covered" >previousStats.totalPoints || 0;</span>
    const previousAmount = <span class="cstat-no" title="statement not covered" >previousStats.totalAmount || 0;</span>
    const previousTotal = <span class="cstat-no" title="statement not covered" >previousCompleted + previousCancelled;</span>
&nbsp;
    const comparison = <span class="cstat-no" title="statement not covered" >{</span>
        completedChange: compareChange(currentCompleted, previousCompleted),
        cancelledChange: compareChange(currentCancelled, previousCancelled),
        totalChange: compareChange(currentTotal, previousTotal),
        pointsChange: compareChange(currentPoints, previousPoints),
        amountChange: compareChange(currentAmount, previousAmount)
    };
&nbsp;
<span class="cstat-no" title="statement not covered" >    return {</span>
        current: {
            completed: currentCompleted,
            cancelled: currentCancelled,
            total: currentTotal,
            points: currentPoints,
            amount: currentAmount
        },
        previous: {
            completed: previousCompleted,
            cancelled: previousCancelled,
            total: previousTotal,
            points: previousPoints,
            amount: previousAmount
        },
        comparison
    };
};
&nbsp;
/**
 * Quên mật khẩu qua email
 */
export const forgotPasswordByEmailService = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (email) =&gt; {</span>
    const user = <span class="cstat-no" title="statement not covered" >await User.findOne({ email });</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!user) {</span>
<span class="cstat-no" title="statement not covered" >        return { success: false, message: "Không tìm thấy người dùng với email này." };</span>
    }
&nbsp;
    // Tạo token đặt lại mật khẩu
    const resetToken = <span class="cstat-no" title="statement not covered" >crypto.randomBytes(32).toString('hex');</span>
    const resetTokenHash = <span class="cstat-no" title="statement not covered" >crypto.createHash('sha256').update(resetToken).digest('hex');</span>
    const resetTokenExpires = <span class="cstat-no" title="statement not covered" >Date.now() + 3600000;</span> // Hết hạn sau 1 giờ
&nbsp;
    // Lưu hash token và thời gian hết hạn
<span class="cstat-no" title="statement not covered" >    user.resetPasswordToken = resetTokenHash;</span>
<span class="cstat-no" title="statement not covered" >    user.resetPasswordExpires = resetTokenExpires;</span>
<span class="cstat-no" title="statement not covered" >    await user.save();</span>
&nbsp;
    // Tạo URL đặt lại mật khẩu
    const resetUrl = <span class="cstat-no" title="statement not covered" >`${process.env.FRONTEND_URL}/reset-password/${resetToken}/${user._id}`;</span>
    const subject = <span class="cstat-no" title="statement not covered" >"Đặt Lại Mật Khẩu";</span>
    const html = <span class="cstat-no" title="statement not covered" >`</span>
        &lt;p&gt;Bạn đã yêu cầu đặt lại mật khẩu cho tài khoản của mình.&lt;/p&gt;
        &lt;p&gt;Vui lòng nhấp vào liên kết sau để đặt lại mật khẩu:&lt;/p&gt;
        &lt;a href="${resetUrl}"&gt;${resetUrl}&lt;/a&gt;
        &lt;p&gt;Liên kết này sẽ hết hạn sau 1 giờ.&lt;/p&gt;
    `;
&nbsp;
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        await sendEmailService(email, subject, html);</span>
<span class="cstat-no" title="statement not covered" >        return { success: true, message: "Liên kết đặt lại mật khẩu đã được gửi đến email của bạn." };</span>
    } catch (error) {
<span class="cstat-no" title="statement not covered" >        console.error("Lỗi khi gửi email đặt lại mật khẩu:", error);</span>
        // Xóa token nếu gửi email thất bại
<span class="cstat-no" title="statement not covered" >        user.resetPasswordToken = undefined;</span>
<span class="cstat-no" title="statement not covered" >        user.resetPasswordExpires = undefined;</span>
<span class="cstat-no" title="statement not covered" >        await user.save();</span>
<span class="cstat-no" title="statement not covered" >        return { success: false, message: "Lỗi khi gửi email đặt lại mật khẩu." };</span>
    }
};
&nbsp;
/**
 * Đặt lại mật khẩu từ liên kết
 */
export const resetPasswordService = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId, token, newPassword) =&gt; {</span>
    const user = <span class="cstat-no" title="statement not covered" >await User.findById(userId);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!user) {</span>
<span class="cstat-no" title="statement not covered" >        return { success: false, message: "Người dùng không tồn tại." };</span>
    }
&nbsp;
    // Xác thực token
    const resetTokenHash = <span class="cstat-no" title="statement not covered" >crypto.createHash('sha256').update(token).digest('hex');</span>
<span class="cstat-no" title="statement not covered" >    if (</span>
        user.resetPasswordToken !== resetTokenHash ||
        !user.resetPasswordExpires ||
        user.resetPasswordExpires &lt; Date.now()
    ) {
<span class="cstat-no" title="statement not covered" >        return { success: false, message: "Liên kết đặt lại mật khẩu không hợp lệ hoặc đã hết hạn." };</span>
    }
&nbsp;
    // Hash mật khẩu mới
    const salt = <span class="cstat-no" title="statement not covered" >await bcrypt.genSalt(10);</span>
    const hashedNewPassword = <span class="cstat-no" title="statement not covered" >await bcrypt.hash(newPassword, salt);</span>
&nbsp;
    // Cập nhật mật khẩu và xóa token
<span class="cstat-no" title="statement not covered" >    user.password_hash = hashedNewPassword;</span>
<span class="cstat-no" title="statement not covered" >    user.resetPasswordToken = undefined;</span>
<span class="cstat-no" title="statement not covered" >    user.resetPasswordExpires = undefined;</span>
<span class="cstat-no" title="statement not covered" >    await user.save();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    return { success: true, message: "Mật khẩu đã được đặt lại thành công." };</span>
};
&nbsp;
/**
 * Thêm đánh giá
 */
export const insertRatingService = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync ({ centerId, userId, stars, comment }) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    if (!centerId || !userId || !stars) {</span>
<span class="cstat-no" title="statement not covered" >        throw { status: 400, message: "Vui lòng điền đầy đủ thông tin!" };</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (stars &lt; 1 || stars &gt; 5) {</span>
<span class="cstat-no" title="statement not covered" >        throw { status: 400, message: "Số sao phải từ 1 đến 5!" };</span>
    }
&nbsp;
    // Kiểm tra nội dung đánh giá có chứa từ không cho phép không
<span class="cstat-no" title="statement not covered" >    if (comment &amp;&amp; containsForbiddenWords(comment)) {</span>
        // Trừ 500 điểm của người dùng, cho phép điểm âm
        const user = <span class="cstat-no" title="statement not covered" >await User.findById(userId);</span>
<span class="cstat-no" title="statement not covered" >        if (!user) {</span>
<span class="cstat-no" title="statement not covered" >            throw { status: 404, message: "Người dùng không tồn tại!" };</span>
        }
&nbsp;
        const newPoints = <span class="cstat-no" title="statement not covered" >user.points - 500;</span> // Cho phép điểm âm
<span class="cstat-no" title="statement not covered" >        user.points = newPoints;</span>
<span class="cstat-no" title="statement not covered" >        await user.save();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        throw { </span>
            status: 400, 
            message: `Hệ thống phát hiện bạn sử dụng các từ không cho phép, bạn đã bị trừ 500 điểm. Điểm hiện tại: ${newPoints}.`,
            pointsDeducted: 500,
            newPoints: newPoints
        };
    }
&nbsp;
    const newRating = <span class="cstat-no" title="statement not covered" >new Rating({</span>
        center: centerId,
        user: userId,
        stars,
        comment,
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    await newRating.save();</span>
<span class="cstat-no" title="statement not covered" >    console.log("✅ Đã thêm rating thành công!");</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    await updateAvgRating(centerId);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    return newRating;</span>
};
&nbsp;
/**
 * Cập nhật trung tâm yêu thích
 */
export const updateFavouriteCenter = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId, centerId) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
        const user = <span class="cstat-no" title="statement not covered" >await User.findById(userId);</span>
<span class="cstat-no" title="statement not covered" >        if (!user) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error("User không tồn tại");</span>
        }
&nbsp;
        const center = <span class="cstat-no" title="statement not covered" >await Center.findById(centerId);</span>
<span class="cstat-no" title="statement not covered" >        if (!center) {</span>
<span class="cstat-no" title="statement not covered" >            throw new Error("Trung tâm không tồn tại");</span>
        }
&nbsp;
        const centerName = <span class="cstat-no" title="statement not covered" >center.name;</span>
&nbsp;
        // Try to increment the count for an existing favorite center
        const updateResult = <span class="cstat-no" title="statement not covered" >await User.updateOne(</span>
            { _id: userId, "favouriteCenter.centerName": centerName },
            { $inc: { "favouriteCenter.$.bookingCount": 1 } }
        );
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (updateResult.matchedCount === 0) {</span>
            // If no existing favorite center was found, add a new one
<span class="cstat-no" title="statement not covered" >            await User.updateOne(</span>
                { _id: userId },
                { $push: { favouriteCenter: { centerName: centerName, bookingCount: 1 } } }
            );
        }
&nbsp;
        const updatedUser = <span class="cstat-no" title="statement not covered" >await User.findById(userId).select('favouriteCenter');</span>
<span class="cstat-no" title="statement not covered" >        console.log(`Đã cập nhật danh sách yêu thích của user ${userId}`);</span>
<span class="cstat-no" title="statement not covered" >        return updatedUser.favouriteCenter;</span>
    } catch (error) {
<span class="cstat-no" title="statement not covered" >        console.error("Error updating favourite center:", error);</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Có lỗi xảy ra khi cập nhật danh sách yêu thích");</span>
    } 
};
&nbsp;
/**
 * Lấy thống kê booking của user
 */
export const getPopularTimeSlot = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId) =&gt; {</span>
    const bookings = <span class="cstat-no" title="statement not covered" >await Booking.find({ status: "paid", userId });</span>
<span class="cstat-no" title="statement not covered" >    console.log(`Found ${bookings.length} booked bookings for user ${userId}`);</span>
&nbsp;
    const timeslotCounts = <span class="cstat-no" title="statement not covered" >{};</span>
    const categoryCounts = <span class="cstat-no" title="statement not covered" >{</span>
        "Sáng": 0,
        "Trưa": 0,
        "Chiều": 0,
        "Tối": 0,
    };
    let totalSlots = <span class="cstat-no" title="statement not covered" >0;</span>
&nbsp;
    const getTimeCategory = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >(s</span>lot) =&gt; {</span>
        const hour = <span class="cstat-no" title="statement not covered" >parseInt(slot);</span>
<span class="cstat-no" title="statement not covered" >        if (hour &gt;= 5 &amp;&amp; hour &lt; 12) <span class="cstat-no" title="statement not covered" >return "Sáng";</span></span>
<span class="cstat-no" title="statement not covered" >        if (hour &gt;= 12 &amp;&amp; hour &lt; 14) <span class="cstat-no" title="statement not covered" >return "Trưa";</span></span>
<span class="cstat-no" title="statement not covered" >        if (hour &gt;= 14 &amp;&amp; hour &lt; 18) <span class="cstat-no" title="statement not covered" >return "Chiều";</span></span>
<span class="cstat-no" title="statement not covered" >        if (hour &gt;= 18 &amp;&amp; hour &lt;= 24) <span class="cstat-no" title="statement not covered" >return "Tối";</span></span>
<span class="cstat-no" title="statement not covered" >        return "Khác";</span>
    };
&nbsp;
<span class="cstat-no" title="statement not covered" >    bookings.forEach(<span class="fstat-no" title="function not covered" >(b</span>ooking) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        if (booking.courts &amp;&amp; Array.isArray(booking.courts)) {</span>
<span class="cstat-no" title="statement not covered" >            booking.courts.forEach(<span class="fstat-no" title="function not covered" >(c</span>ourt) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >                if (Array.isArray(court.timeslots)) {</span>
<span class="cstat-no" title="statement not covered" >                    court.timeslots.forEach(<span class="fstat-no" title="function not covered" >(s</span>lot) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >                        totalSlots++;</span>
<span class="cstat-no" title="statement not covered" >                        timeslotCounts[slot] = (timeslotCounts[slot] || 0) + 1;</span>
                        const category = <span class="cstat-no" title="statement not covered" >getTimeCategory(slot);</span>
<span class="cstat-no" title="statement not covered" >                        if (category in categoryCounts) {</span>
<span class="cstat-no" title="statement not covered" >                            categoryCounts[category] += 1;</span>
                        }
                    });
                }
            });
        }
    });
&nbsp;
    let popularSlot = <span class="cstat-no" title="statement not covered" >null;</span>
    let maxCount = <span class="cstat-no" title="statement not covered" >0;</span>
<span class="cstat-no" title="statement not covered" >    for (const slot in timeslotCounts) {</span>
<span class="cstat-no" title="statement not covered" >        if (timeslotCounts[slot] &gt; maxCount) {</span>
<span class="cstat-no" title="statement not covered" >            maxCount = timeslotCounts[slot];</span>
<span class="cstat-no" title="statement not covered" >            popularSlot = slot;</span>
        }
    }
&nbsp;
    let popularTimeRange = <span class="cstat-no" title="statement not covered" >null;</span>
<span class="cstat-no" title="statement not covered" >    if (popularSlot !== null) {</span>
        const startHour = <span class="cstat-no" title="statement not covered" >parseInt(popularSlot);</span>
        const startTime = <span class="cstat-no" title="statement not covered" >startHour.toString().padStart(2, "0") + ":00";</span>
        const totalTime = <span class="cstat-no" title="statement not covered" >startHour + 1;</span>
        const endHour = <span class="cstat-no" title="statement not covered" >Math.floor(totalTime);</span>
        const endMinutes = <span class="cstat-no" title="statement not covered" >(totalTime - endHour) * 60;</span>
        const endTime = <span class="cstat-no" title="statement not covered" >endHour.toString().padStart(2, "0") + ":" + (endMinutes === 30 ? "30" : "00");</span>
<span class="cstat-no" title="statement not covered" >        popularTimeRange = `${startTime} - ${endTime}`;</span>
    }
&nbsp;
    const categoryPercentages = <span class="cstat-no" title="statement not covered" >{};</span>
<span class="cstat-no" title="statement not covered" >    Object.keys(categoryCounts).forEach(<span class="fstat-no" title="function not covered" >(c</span>at) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        categoryPercentages[cat] = totalSlots &gt; 0 ? parseFloat(((categoryCounts[cat] / totalSlots) * 100)).toFixed(2) : "0.00";</span>
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    return {</span>
        popularSlot,
        popularTimeRange,
        popularCount: maxCount,
        categoryDistribution: {
            counts: categoryCounts,
            percentages: categoryPercentages,
            total: totalSlots,
        },
        timeslotCounts,
    };
};
&nbsp;
export const getBookingHistory = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >as</span>ync (userId, page = <span class="branch-0 cbranch-no" title="branch not covered" >1,</span> limit = <span class="branch-0 cbranch-no" title="branch not covered" >10)</span> =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    try {</span>
        const pageNum = <span class="cstat-no" title="statement not covered" >parseInt(page);</span>
        const limitNum = <span class="cstat-no" title="statement not covered" >parseInt(limit);</span>
        const skip = <span class="cstat-no" title="statement not covered" >(pageNum - 1) * limitNum;</span>
&nbsp;
        const totalBookings = <span class="cstat-no" title="statement not covered" >await Booking.countDocuments({ userId, deleted: { $ne: true } });</span>
&nbsp;
        const bookings = <span class="cstat-no" title="statement not covered" >await Booking.find({ userId, deleted: { $ne: true } })</span>
            .skip(skip)
            .limit(limitNum)
            .sort({ date: -1 })
            .lean(); // Use .lean() for faster query results when not modifying documents
&nbsp;
        const dailyBookings = <span class="cstat-no" title="statement not covered" >bookings.filter(<span class="fstat-no" title="function not covered" >(b</span>ooking) =&gt; <span class="cstat-no" title="statement not covered" >booking.type === "daily")</span>;</span>
        const fixedBookings = <span class="cstat-no" title="statement not covered" >bookings.filter(<span class="fstat-no" title="function not covered" >(b</span>ooking) =&gt; <span class="cstat-no" title="statement not covered" >booking.type === "fixed")</span>;</span>
&nbsp;
        let history = <span class="cstat-no" title="statement not covered" >[];</span>
&nbsp;
        // Process daily bookings
<span class="cstat-no" title="statement not covered" >        for (const booking of dailyBookings) {</span>
            const center = <span class="cstat-no" title="statement not covered" >await Center.findById(booking.centerId).select("name").lean();</span>
&nbsp;
            const courtTimeArray = <span class="cstat-no" title="statement not covered" >await Promise.all(</span>
                booking.courts.map(<span class="fstat-no" title="function not covered" >as</span>ync (court) =&gt; {
                    const courtDoc = <span class="cstat-no" title="statement not covered" >await Court.findById(court.courtId).select("name").lean();</span>
<span class="cstat-no" title="statement not covered" >                    return `${courtDoc ? courtDoc.name : court.courtId} - ${court.timeslots.join(", ")}`;</span>
                })
            );
            const courtTime = <span class="cstat-no" title="statement not covered" >courtTimeArray.join("; ");</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            history.push({</span>
                bookingId: booking._id,
                orderId: booking.status === "pending" ? booking._id : booking.bookingCode,
                status: booking.status,
                orderType: booking.type,
                center: center ? center.name : "Không xác định",
                court_time: courtTime,
                date: booking.date,
                price: booking.totalAmount,
                paymentMethod: booking.status === "paid" ? booking.paymentMethod : "",
            });
        }
&nbsp;
        // Group fixed bookings
        const fixedGroups = <span class="cstat-no" title="statement not covered" >{};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        for (const booking of fixedBookings) {</span>
            const courtsKey = <span class="cstat-no" title="statement not covered" >JSON.stringify(</span>
                booking.courts.map(<span class="fstat-no" title="function not covered" >(c</span>ourt) =&gt; (<span class="cstat-no" title="statement not covered" >{</span>
                    courtId: court.courtId.toString(),
                    timeslots: court.timeslots.sort(),
                }))
            );
            const groupKey = <span class="cstat-no" title="statement not covered" >`${booking.centerId}-${courtsKey}`;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (!fixedGroups[groupKey]) {</span>
<span class="cstat-no" title="statement not covered" >                fixedGroups[groupKey] = {</span>
                    bookingIds: [],
                    dates: [],
                    centerId: booking.centerId,
                    courts: booking.courts,
                    status: booking.status,
                    totalAmount: 0,
                    paymentMethod: booking.paymentMethod,
                    bookingCode: booking.bookingCode.split("-").slice(0, 2).join("-"),
                };
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            fixedGroups[groupKey].bookingIds.push(booking._id);</span>
<span class="cstat-no" title="statement not covered" >            fixedGroups[groupKey].dates.push(new Date(booking.date));</span>
<span class="cstat-no" title="statement not covered" >            fixedGroups[groupKey].totalAmount += booking.totalAmount || 0;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        for (const groupKey in fixedGroups) {</span>
            const group = <span class="cstat-no" title="statement not covered" >fixedGroups[groupKey];</span>
            const center = <span class="cstat-no" title="statement not covered" >await Center.findById(group.centerId).select("name").lean();</span>
&nbsp;
            const courtTimeArray = <span class="cstat-no" title="statement not covered" >await Promise.all(</span>
                group.courts.map(<span class="fstat-no" title="function not covered" >as</span>ync (court) =&gt; {
                    const courtDoc = <span class="cstat-no" title="statement not covered" >await Court.findById(court.courtId).select("name").lean();</span>
<span class="cstat-no" title="statement not covered" >                    return `${courtDoc ? courtDoc.name : court.courtId} - ${court.timeslots.join(", ")}`;</span>
                })
            );
            const courtTime = <span class="cstat-no" title="statement not covered" >courtTimeArray.join("; ");</span>
&nbsp;
            const dates = <span class="cstat-no" title="statement not covered" >group.dates.sort(<span class="fstat-no" title="function not covered" >(a</span>, b) =&gt; <span class="cstat-no" title="statement not covered" >a - b)</span>;</span>
            const startDate = <span class="cstat-no" title="statement not covered" >dates[0];</span>
            const endDate = <span class="cstat-no" title="statement not covered" >dates[dates.length - 1];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            history.push({</span>
                bookingId: group.bookingIds,
                orderId: group.status === "pending" ? group.bookingIds[0] : group.bookingCode,
                status: group.status,
                orderType: "fixed",
                center: center ? center.name : "Không xác định",
                court_time: courtTime,
                date: startDate,
                startDate: startDate,
                endDate: endDate,
                price: group.totalAmount,
                paymentMethod: group.status === "paid" ? group.paymentMethod : "",
            });
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        history.sort(<span class="fstat-no" title="function not covered" >(a</span>, b) =&gt; <span class="cstat-no" title="statement not covered" >new Date(b.date) - new Date(a.date))</span>;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        return {</span>
            history,
            total: totalBookings,
            page: pageNum,
            limit: limitNum,
            totalPages: Math.ceil(totalBookings / limitNum),
        };
    } catch (error) {
<span class="cstat-no" title="statement not covered" >        console.error("Lỗi khi lấy booking history:", error);</span>
<span class="cstat-no" title="statement not covered" >        throw new Error("Không thể lấy lịch sử đặt sân");</span>
    }
};
&nbsp;</pre></td></tr></table></pre>

                <div class='push'></div><!-- for sticky footer -->
            </div><!-- /wrapper -->
            <div class='footer quiet pad2 space-top1 center small'>
                Code coverage generated by
                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
                at 2025-05-26T05:58:32.208Z
            </div>
        <script src="../../prettify.js"></script>
        <script>
            window.onload = function () {
                prettyPrint();
            };
        </script>
        <script src="../../sorter.js"></script>
        <script src="../../block-navigation.js"></script>
    </body>
</html>
    